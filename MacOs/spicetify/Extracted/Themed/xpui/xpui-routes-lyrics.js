"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[6025],{22578:(e,r,t)=>{t.d(r,{$:()=>v});t(26699),t(32023),t(69600),t(68309),t(21249);var n=t(67294),a=t(64593),i=t(96206),c=t(69691),l=t(8341),o=t(89952),u=t(51615),s=t(24183);function d(e){return e.includes("Spotify")?e:"Spotify – ".concat(e)}var v=function(e){var r,t,v,m,f,g,y,p=e.children,b=e.usePlayingItem,k=d(p);r=p,m=(0,s.Oh)().mainLandmarkRef,f=(0,u.k6)(),g=null===(t=f.location)||void 0===t||null===(v=t.state)||void 0===v?void 0:v.preventMoveFocus,(y=(0,n.useRef)(f.length<2)).current=f.length<2,(0,n.useEffect)((function(){var e=m.current;!g&&!y.current&&e&&r&&(e.setAttribute("aria-label",r),e.focus())}),[r,m,g]);var E=(0,c.IK)().isPlaying,h=(0,l.Y)((function(e){return null==e?void 0:e.item}));return h&&(E||b)&&((0,o.G_)(h)?k=[h.name,h.artists.map((function(e){return e.name})).join(i.ag.getSeparator())].join(" • "):(0,o.iw)(h)?k=[h.name,h.show.name].join(" • "):(0,o.k6)(h)&&(k=d(i.ag.get("ad-formats.advertisement")))),n.createElement(a.q,{defaultTitle:"Spotify",defer:!1},n.createElement("title",null,k))}},70369:(e,r,t)=>{t.d(r,{$:()=>n.$});var n=t(22578)},18130:(e,r,t)=>{t.r(r),t.d(r,{default:()=>Fe});var n=t(4942),a=t(67294),i=t(35150),c=t(86706),l=t(69518),o=t.n(l),u=t(73012),s=t(87577),d=t(37081),v=t(49207),m=t(39270),f=t(8341),g=t(55799),y=t(49104),p=t(70369),b=t(57451),k=t(15861),E=t(87757),h=t.n(E),S=t(88767),L=(t(21249),t(96511)),N=t(6086);var x=t(68120);function w(e,r,t){return O.apply(this,arguments)}function O(){return(O=(0,k.Z)(h().mark((function e(r,t,n){var a,i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,x.S)(r,t,n);case 3:return i=e.sent,e.abrupt("return",{hasLyrics:!0,isTimeSynced:_(i.lyrics.syncType),syncType:i.lyrics.syncType,lyrics:i.lyrics.lines.map(I),colors:T(i.colors),provider:i.lyrics.provider,providerDisplayName:i.lyrics.providerDisplayName,providerLyricsId:i.lyrics.providerLyricsId,hasVocalRemoval:null!==(a=i.hasVocalRemoval)&&void 0!==a&&a});case 7:if(e.prev=7,e.t0=e.catch(0),!(e.t0 instanceof L.m&&404===e.t0.status)){e.next=11;break}return e.abrupt("return",{hasLyrics:!1});case 11:throw e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function I(e,r,t){var n=e.startTimeMs,a=e.words,i=t[r+1];return{start:n||0,end:i&&i.startTimeMs?i.startTimeMs:1/0,text:a}}function T(e){return{text:D(e.text),activeText:D(e.highlightText),background:D(e.background)}}function D(e){var r=function(e){return{r:e>>16&255,g:e>>8&255,b:255&e}}(e);return N.I.fromRGB(r).toCSS(N.j.RGB)}function _(e){return"LINE_SYNCED"===e||"SYLLABLE_SYNCED"===e}var C=18e5,B=function(e,r){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=["lyrics",{uri:e,image:r,vocalRemoval:t}],a=(0,S.useQuery)(n,(0,k.Z)(h().mark((function n(){return h().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e&&r&&o().isTrack(e)){n.next=2;break}return n.abrupt("return",{hasLyrics:!1});case 2:return n.next=4,w(e,r,t);case 4:return n.abrupt("return",n.sent);case 5:case"end":return n.stop()}}),n)}))),{cacheTime:C}),i=a.data,c=a.isLoading,l=a.isError;return{data:null!=i?i:null,loading:c,error:l}},P=t(93433),G=t(29439),F=(t(92222),t(34553),t(47941),t(82526),t(57327),t(41539),t(38880),t(89554),t(54747),t(49337),t(33321),t(69070),t(32667)),V=t(81898),j=t(96206),A=t(23716),R=t(52759),Z=t(15852),Y=t(24643),H=t(8271);var M=t(97650),U=t(32648);const W="lyrics-lyrics-contentContainer",z="lyrics-lyrics-contentWrapper",J="lyrics-lyricsContent-lyric",q="lyrics-lyricsContent-active",K="lyrics-lyricsContent-highlight",Q="lyrics-lyricsContent-unsynced",$="lyrics-lyricsContent-provider",X="lyrics-lyricsContent-description";var ee=a.memo((function(e){var r,t=e.onObserve,c=e.text,l=e.lineNumber,o=e.activeLineIndex,u=e.isTimeSynced,s=e.handleLyricsClick,d=(0,M.YD)({threshold:0,triggerOnce:!0}),v=d.ref,m=d.inView;(0,a.useEffect)((function(){m&&t(c)}),[m,t,c]);var f=(0,a.useRef)(),g=(0,a.useRef)(!0),y=(0,a.useContext)(U.VX);(0,a.useEffect)((function(){if(u&&o===l||u&&0===l&&o<0){var e,r,t,n=null===(e=f.current)||void 0===e?void 0:e.getBoundingClientRect().top,a=null===(r=y.scrollNodeRef.current)||void 0===r?void 0:r.getBoundingClientRect().height,i=a/4;if((n<i||n>a-i)&&!g.current&&o>=0)return;var c=g.current?"auto":"smooth";null===(t=f.current)||void 0===t||t.scrollIntoView({behavior:c,block:"center",inline:"center"})}g.current=!1}),[o,u,l,f,y]);var p=(0,a.useCallback)((function(e){v(e),f.current=e||void 0}),[v]);return a.createElement("div",{dir:"auto",className:(0,i.cx)(J,(r={},(0,n.Z)(r,q,o===l),(0,n.Z)(r,K,o>l),(0,n.Z)(r,Q,!u),r)),"data-testid":"fullscreen-lyric",ref:p,onClick:function(e){return s(e,l)}},c)}));function re(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function te(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?re(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):re(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var ne={start:0,end:1,text:""},ae=a.memo((function(e){var r=e.trackUri,t=e.data,n=t.lyrics,i=void 0===n?[]:n,c=t.provider,l=t.providerLyricsId,o=t.providerDisplayName,u=t.syncType,s=t.isTimeSynced,d=(0,Z.fU)(V.createDesktopLyricsEventFactory,{data:{uri:r}}),v=d.spec,m=d.logger,g=(0,R.z)(500,(function(e){var t;return(null==e||null===(t=e.item)||void 0===t?void 0:t.uri)===r})),y=(0,G.Z)(g,1)[0],p=(0,f.Y)((function(e){var r;return null!==(r=null==e?void 0:e.playbackId)&&void 0!==r?r:void 0})),b=function(e){var r=e.trackUri,t=e.format,n=e.provider,i=e.providerLyricsId,c=e.syncType,l=e.playbackId,o=(0,a.useState)(!1),u=(0,G.Z)(o,2),s=u[0],d=u[1],v=(0,a.useState)(0),m=(0,G.Z)(v,2),f=m[0],g=m[1],y=(0,a.useMemo)((function(){return(0,Y.N)({lyrics_format:t,track_uri:r,provider:n,provider_lyrics_id:i,sync_type:c,playback_id:l})}),[t,n,i,c,r,l]);(0,a.useEffect)((function(){d(!1),g(0)}),[y]);var p=(0,H.s4)();return(0,a.useEffect)((function(){s||f>=140&&(p.send(y),d(!0))}),[f,s,y,p]),g}({trackUri:r,format:"fullscreen",provider:c,providerLyricsId:l,syncType:u,playbackId:p}),k=(0,a.useCallback)((function(e){e.length>1&&b((function(r){return r+e.length}))}),[b]),E=(0,a.useMemo)((function(){return[ne,ne].concat((0,P.Z)(i)).map((function(e,r){return te(te({},e),{},{lineNumber:r})}))}),[i]),h=s?E.findIndex((function(e){var r=e.start,t=e.end;return y>=r&&y<t})):-1,S=(0,A.g)(),L=(0,a.useCallback)((function(e,r){if(s){var t=E[r].start,n=v.lyricsLineFactory().hitSeekToTime({msToSeekTo:t});m.logInteraction(n),e.target.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),S.seekTo(t);var a=S.getState();a&&!a.isPaused||S.resume()}}),[s,m,E,S,v]);return a.createElement("div",{className:W},a.createElement("div",{className:z},!s&&a.createElement(F.D,{as:"p",variant:"mesto",className:X,dir:"auto"},j.ag.get("web-player.lyrics.unsynced")),E.map((function(e){var r=e.text,t=e.lineNumber;return a.createElement(ee,{key:t,text:r,lineNumber:t,activeLineIndex:h,isTimeSynced:s,onObserve:k,handleLyricsClick:L})})),o&&a.createElement(F.D,{as:"p",variant:"mesto",className:$,dir:"auto"},j.ag.get("web-player.lyrics.providedBy",o))))})),ie=t(38470);const ce="lyrics-lyrics-container",le="IIFWQwWvkxpl3swKeHSx",oe="ihTTWcgqNLcQ_cg7Bubg",ue="T67LFP0PElpfkkLuegQt",se="lyrics-lyrics-background",de="YRcOaDMQH71HylItIhW6",ve="EKdvOmPl7kNCDg_yuma8";var me=a.memo((function(e){var r,t=e.version,n=[j.ag.get("web-player.lyrics.noLyrics0"),j.ag.get("web-player.lyrics.noLyrics1"),j.ag.get("web-player.lyrics.noLyrics2"),j.ag.get("web-player.lyrics.noLyrics3")];switch(t){case"ad":r=j.ag.get("web-player.lyrics.ad");break;case"error":r=j.ag.get("web-player.lyrics.error");break;case"unavailable":r=n[Math.floor(Math.random()*n.length)];break;default:(0,ie.U)(t)}return a.createElement("div",{className:ue},a.createElement("span",{className:ve},r))})),fe=(t(69826),t(94184)),ge=t.n(fe),ye=t(92949),pe=t(96314),be=t(21864),ke=t(64570),Ee=t(34142),he=t(47921),Se=t(32626),Le=t(30005),Ne=t(36652),xe=t(21691),we=t(66587);const Oe="qnJd7AVNVGM33NxaibzG",Ie="tPJJwfJAQV0WDsE9Kfmd";var Te=[{volume:we.B.SING_ALONG_OFF,icon:a.createElement(ye.D,{iconSize:16}),get label(){return j.ag.get("singalong.off")}},{volume:we.B.HIGH,icon:a.createElement(pe.d,{iconSize:16}),get label(){return j.ag.get("singalong.more-vocal")}},{volume:we.B.LOW,icon:a.createElement(be.J,{iconSize:16}),get label(){return j.ag.get("singalong.less-vocal")}}],De=a.memo((function(e){var r=function(e){var r=(0,g.$)(),t=(0,a.useState)(we.B.SING_ALONG_OFF),n=(0,G.Z)(t,2),i=n[0],c=n[1],l=r.getCapabilities().isSupported;(0,a.useEffect)((function(){r.setStatus(we.q.DISABLED).then((function(){c(we.B.SING_ALONG_OFF)}))}),[e,r]),(0,a.useEffect)((function(){return function(){r.setStatus(we.q.DISABLED)}}),[r]);var o=(0,a.useCallback)(function(){var e=(0,k.Z)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==we.B.SING_ALONG_OFF){e.next=5;break}return e.next=3,r.setStatus(we.q.DISABLED);case 3:e.next=7;break;case 5:return e.next=7,r.setStatus(we.q.ENABLED);case 7:return e.next=9,r.setVocalVolume(t);case 9:c(t);case 10:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),[r]);return{isSupported:l,volume:i,setVocalVolume:o}}(e.currentTrackUri),t=r.isSupported,i=r.volume,c=r.setVocalVolume,l=(0,a.useCallback)((function(e){t&&c(e.volume)}),[t,c]);if(!t)return null;var o=Te.find((function(e){return e.volume===i})),u=(null==o?void 0:o.volume)===we.B.SING_ALONG_OFF;return a.createElement(Se.yj,{menu:a.createElement(Le.v,null,a.createElement(Ne.F,null,j.ag.get("singalong.title")),Te.map((function(e){return a.createElement(xe.s,{role:"menuitemradio","aria-checked":i===e.volume,"aria-label":e.label,key:e.volume,onClick:function(){return l(e)},icon:e.icon,iconPosition:"leading"},e.label)})))},(function(e,r,t){return a.createElement("button",{onClick:r,ref:t,type:"button",className:ge()(Oe,(0,n.Z)({},Ie,u))},u?a.createElement(a.Fragment,null,a.createElement(ke.r,{iconSize:16}),a.createElement(F.D,{variant:"mesto"},j.ag.get("singalong.button"))):a.createElement(a.Fragment,null,o.icon,a.createElement(F.D,{variant:"mesto"},o.label)),e?a.createElement(Ee.U,{iconSize:16}):a.createElement(he.i,{iconSize:16}))}))})),_e=a.createElement("div",{className:oe},a.createElement(b.H,null)),Ce=a.createElement(me,{version:"error"}),Be=a.createElement(me,{version:"ad"}),Pe=a.createElement(me,{version:"unavailable"}),Ge={active:u.ixZ,inactive:u.Snx,background:u.tGJ,messaging:u.ixZ};const Fe=function(){var e,r,t,l,u=(0,g.$)().getCapabilities().isSupported,b=(0,s.W6)(v.cp)&&u,k=(0,m.O)(),E=(0,f.Y)((function(e){return null==e?void 0:e.item}),(function(e,r){return(null==e?void 0:e.uri)===(null==r?void 0:r.uri)})),h=(null==E?void 0:E.uri)||"",S=(0,y.o)((null==E?void 0:E.images)||void 0,{desiredLabel:"large",desiredSize:600}),L=B(h,S||(null==E||null===(e=E.images)||void 0===e||null===(r=e[0])||void 0===r?void 0:r.url)||"",b),N=L.data,x=L.loading,w=L.error,O=Ge;null!=N&&N.hasLyrics&&(O={active:N.colors.activeText,inactive:N.colors.text,background:N.colors.background,messaging:N.colors.text}),(0,d.Y)(O.background,Ge.background);var I=(0,f.Y)((function(e){var r;return null==e||null===(r=e.nextItems)||void 0===r?void 0:r[0]}),(function(e,r){return(null==e?void 0:e.uri)===(null==r?void 0:r.uri)}));B((null==I?void 0:I.uri)||"",(null==I||null===(t=I.images)||void 0===t||null===(l=t[0])||void 0===l?void 0:l.url)||"",b);var T=_e,D=!1;if(h)if(o().isAd(h))T=Be;else if(w)T=Ce;else if(x)T=_e;else if(N)if(N.hasLyrics){var _,C,P=null!==(_=null===(C=k.activeDevice)||void 0===C?void 0:C.isLocal)&&void 0!==_&&_;D=b&&N.hasVocalRemoval&&P,T=a.createElement(ae,{trackUri:h,data:N,key:h})}else T=Pe;var G=(0,c.v9)((function(e){return e.ads.leaderboard.isEnabled})),F={"--lyrics-color-active":O.active,"--lyrics-color-inactive":O.inactive,"--lyrics-color-background":O.background,"--lyrics-color-messaging":O.messaging};return a.createElement(a.Fragment,null,a.createElement(p.$,{usePlayingItem:!0},"Spotify"),a.createElement("div",{className:(0,i.cx)(ce,(0,n.Z)({},le,G)),style:F},a.createElement("div",{className:se}),T,D?a.createElement("div",{className:de},a.createElement(De,{currentTrackUri:h})):null))}}}]);
//# sourceMappingURL=xpui-routes-lyrics.js.map