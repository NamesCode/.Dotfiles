"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[7704],{70578:(e,t,s)=>{s.r(t),s.d(t,{SKELETON_CARDS_COUNT:()=>gt,SKELETON_SHELVES_COUNT:()=>pt,SKELETON_SHORTCUTS_COUNT:()=>xt,default:()=>yt});var n=s(59496),i=s(84875),o=s.n(i),a=s(94405),r=s(25007),c=s(31716),l=s(20501),u=s(64185),m=s(29959),d=s(36080),h=s(92910),x=s(31340),p=s(95738),g=s(51182),j=s(88585),f=s.n(j),y=s(65242),v=s(96794),C=s(83972),S=s(14368),N=s(38205),T=s(71721),k=s(34419),P=s(43181),_=s(86800),w=s(96551),E=s(44481),b=s(60003),B=s(80131),I=s(31269),L=s(18154),U=s(53703);const O="view-homeShortcutsGrid-shortcuts",A="view-homeShortcutsGrid-grid",F="view-homeShortcutsGrid-shortcutLink",D="view-homeShortcutsGrid-shortcut",M="view-homeShortcutsGrid-draggable",H="view-homeShortcutsGrid-imageContainer",R="view-homeShortcutsGrid-imageWrapper",z="view-homeShortcutsGrid-image",G="view-homeShortcutsGrid-main",W="view-homeShortcutsGrid-nameWrapper",Z="view-homeShortcutsGrid-name",q="EzRmGRncgnv1zFgF4dqE",J="bPmmKmSPLKMhtJSaUJRX",Y="vpQWUBWS_lXRLZMRJT7w",$="GSv7K805J9Jw7LB9tn2A",K="view-homeShortcutsGrid-PlayButtonContainer",V="s9c9x_mJq197U2hBzGtV";var X=s(4637);const Q=(0,n.memo)((function({item:e}){const t=(0,I._)(e.uri),s=e.duration_ms??0,{isPlaying:n,isActive:i}=(0,U.$o)(e.uri),[o]=(0,L.z)(1e4,(t=>t.item?.uri===e.uri)),a=e.resume_point?.resume_position_ms??0,r=n||i?o:a,c=Math.round(100/(s/r)),l=t===B.Om.YES,u=s&&r>0;return l||u?(0,X.jsxs)("div",{className:Y,children:[l?(0,X.jsx)(E.E,{iconSize:16,semanticColor:"textSubdued"}):null,u?(0,X.jsx)(b.k,{className:$,value:c,semanticColor:"essentialBase"}):null]}):null}));s(10817);var ee=s(86695),te=s(88778),se=s(69758),ne=s(11116),ie=s(69142),oe=s(20858),ae=s(98082),re=s(77003),ce=s(72899),le=s(68001),ue=s(91800),me=s(90538),de=s(57559);const he=(0,n.memo)((function({images:e=[],fallbackIcon:t=y.U}){const s=(0,de.X)(e);return(0,X.jsx)("div",{className:H,children:(0,X.jsx)("div",{className:R,children:(0,X.jsx)(me.E,{className:z,src:s?.url,loading:"lazy",testid:"shortcut-image",children:(0,X.jsx)(t,{"aria-hidden":!0})})})})})),xe=n.memo((function({index:e,item:t,fallbackIcon:s,showPlayButton:i,extraContent:a,onContextMenu:r=(()=>{}),onTouchStart:c=(()=>{}),onTouchEnd:l=(()=>{})}){const u=(0,ee.k6)(),m=(0,le.o)(),{setColorFromUri:d,resetColor:h,clearColor:x}=(0,g.WQ)(),p=(0,oe.G3)(t.uri,t.release_date,t.resume_point?.resume_position_ms,t.resume_point?.fully_played),{spec:j,logger:f}=(0,re.fU)(se.createDesktopShortcutsPlayNavCardEventFactory,{data:{position:e,uri:t.uri}}),{isPlaying:y,isActive:v,togglePlay:C}=(0,ae.n)({uri:t.uri},{featureIdentifier:"home",referrerIdentifier:"home"});const S=(0,n.useCallback)((()=>{m({targetUri:t.uri,intent:"navigate",type:"click"});const e=j.hitUiNavigate({destination:t.uri});f.logInteraction(e),u.push((0,ne.EC)(t.uri).toURLPath(!0))}),[u,t.uri,f,m,j]),N=(0,n.useCallback)((()=>{d(t.uri)}),[t.uri,d]);(0,n.useEffect)((()=>()=>{x()}),[x]);const T=(0,re.Wi)(j),k=(0,ce.O1)([t.uri],t.name);return(0,X.jsx)("div",{ref:T,className:D,onContextMenu:r,onTouchStart:c,onTouchEnd:l,onMouseEnter:N,onMouseLeave:h,children:(0,X.jsxs)("div",{className:M,onDragStart:k,children:[(0,X.jsx)(he,{images:t.images,fallbackIcon:s}),(0,X.jsxs)("div",{className:G,children:[(0,X.jsxs)("div",{className:W,children:[(0,X.jsxs)("div",{className:Z,children:[p&&(0,X.jsx)(oe.Rd,{className:J}),(0,X.jsx)(ue.r,{to:t.uri,onClick:S,title:t.name,children:(0,X.jsx)(te.D,{as:"p",variant:"balladBold",className:q,children:t.name})})]}),a||null]}),i&&(0,X.jsx)("div",{className:o()(K,{[V]:y}),children:(0,X.jsx)(ie.f,{isPlaying:y,onClick:function(){m({targetUri:t.uri,intent:y?"pause":"play",type:"click"});const e=j.playButtonFactory();let s;s=y?e.hitPause({itemToBePaused:t.uri}):v?e.hitResume({itemToBeResumed:t.uri}):e.hitPlay({itemToBePlayed:t.uri});const n=f.logInteraction(s);C({loggingParams:n})}})})]}),(0,X.jsx)("div",{onClick:S,className:F})]})})})),pe=n.memo((function(e){return f().isCollection(e.item.uri)?(0,X.jsx)(xe,{...e,fallbackIcon:y.U}):(0,X.jsx)(N._,{menu:(0,X.jsx)(_.X,{uri:e.item.uri}),children:(0,X.jsx)(xe,{...e,fallbackIcon:y.U})})})),ge=n.memo((function(e){return(0,X.jsx)(N._,{menu:(0,X.jsx)(T.Y,{uri:e.item.uri}),children:(0,X.jsx)(xe,{...e,fallbackIcon:v.c})})})),je=n.memo((function(e){return(0,X.jsx)(N._,{menu:(0,X.jsx)(k.m,{uri:e.item.uri}),children:(0,X.jsx)(xe,{...e,fallbackIcon:C.a})})})),fe=n.memo((function(e){return(0,X.jsx)(N._,{menu:(0,X.jsx)(w.M,{uri:e.item.uri}),children:(0,X.jsx)(xe,{...e,fallbackIcon:S.J,showPlayButton:!1})})})),ye=n.memo((function(e){return e.item.podcast?(0,X.jsx)(fe,{index:e.index,shouldSetBackgroundColor:e.shouldSetBackgroundColor,item:e.item.podcast,showPlayButton:e.showPlayButton}):(0,X.jsx)(N._,{menu:(0,X.jsx)(P.k,{uri:e.item.uri}),children:(0,X.jsx)(xe,{...e,fallbackIcon:S.J,extraContent:(0,X.jsx)(Q,{...e})})})}));var ve=s(87710),Ce=s(57207);const Se="J6UEDIqMSJhYlwGoeUZB",Ne="ZjFf4lVC48DSryAjP9qB",Te=n.memo((function(e){const t=(0,Ce.x)(),s={...e.item,...t};return(0,X.jsx)(xe,{...e,item:s,fallbackIcon:()=>(0,X.jsx)("div",{className:Se,children:(0,X.jsx)(ve.P,{iconSize:32,className:Ne})})})})),ke=24,Pe=270;function _e(e){if(null===e)return{cssProperties:{"--min-column-width":"270px","--item-height":"80px","--column-gap":"24px","--row-gap":"16px"},showPlayButton:!0};const t=e.offsetWidth,s=t<600?200:Pe;const n=Math.min(Math.floor((t+ke)/(s+ke)),3),i=t>=858?80:64;return{cssProperties:{"--min-column-width":`${s}px`,"--item-height":`${i}px`,"--column-gap":"24px","--row-gap":`${64===i?12:16}px`},showPlayButton:(t-(n-1)*ke)/n>=Pe}}function we(){const e=(0,n.useRef)(null),[t,s]=(0,n.useState)(_e(null)),i=(0,n.useCallback)((()=>{null!==e.current&&s(_e(e.current))}),[]),o=(0,n.useCallback)((t=>{e.current=t,i()}),[i]);return(0,m.a)((()=>i())),[t,o]}const Ee=e=>{if(null!==e&&"object"==typeof e){const{type:t,name:s}=e;return t===h.p.YOUR_EPISODES&&"string"==typeof s}return!1},be=n.memo((function({title:e,tagline:t,items:s}){const{fetchMultipleColors:i}=(0,g.WQ)(),o=!(0,x.k)(),a=e??(()=>{const e=(new Date).getHours();let t=r.ag.get("home.evening");return e>=5&&e<12?t=r.ag.get("home.morning"):e>=12&&e<18&&(t=r.ag.get("home.afternoon")),t})(),[c,l]=we();return(0,n.useEffect)((()=>{const e=s?.map(g.lh)||[];i(e)}),[s,i]),o||!s?.length?null:(0,X.jsxs)("section",{className:O,"aria-label":a,ref:l,children:[(0,X.jsx)(p.r,{title:a,titleVariant:"alto",tagline:t}),(0,X.jsx)("div",{className:A,style:c.cssProperties,children:s.filter(((e,t)=>Ee(e)||!e.error)).filter(((e,t)=>t<6)).map(((e,t)=>{if(Ee(e))return(0,X.jsx)(Te,{index:t,item:e,showPlayButton:c.showPlayButton,shouldSetBackgroundColor:0===t},`${t}-${e.uri}`);const s=function(e){const t=(f().from(e)||{}).type;switch(t){case f().Type.ARTIST:return je;case f().Type.ALBUM:case f().Type.COLLECTION_ALBUM:return ge;case f().Type.PLAYLIST:case f().Type.PLAYLIST_V2:return pe;case f().Type.SHOW:return fe;case f().Type.EPISODE:return ye;case f().Type.COLLECTION:return pe;default:return console.warn(`Unable to resolve entity shortcut from ${e} of type "${t||"unknown"}"`),fe}}(e.uri);return(0,X.jsx)(s,{index:t,item:e,showPlayButton:c.showPlayButton,shouldSetBackgroundColor:0===t},`${t}-${e.uri}`)}))})]})})),Be=e=>(0,X.jsx)(u.L,{onError:e=>{(0,d.vK)(e,"HomeShortcutsGrid")},children:(0,X.jsx)(be,{...e})});var Ie=s(33036);const Le="zUf7jtv9GPOKC1jYO5TO",Ue="T8QLel3PoQTgJUpGYj7Q",Oe=(0,n.memo)((({isLoading:e})=>{const t=(0,Ie.h)("shimmer");return(0,X.jsx)("div",{className:H,children:(0,X.jsx)("div",{ref:t,className:o()(R,{[Ue]:e})})})})),Ae=(0,n.memo)((({isLoading:e})=>(0,X.jsx)("div",{className:o()(D,Le),"data-testid":"skeleton-shortcut",children:(0,X.jsxs)("div",{className:M,children:[(0,X.jsx)(Oe,{isLoading:e}),(0,X.jsx)("div",{className:G,children:(0,X.jsx)(l.C,{as:"p",variant:"balladBold",className:q,isLoading:e})})]})}))),Fe="v7dc5ekmeBiAYnLzV8oT",De=(0,n.memo)((({shortcutCount:e})=>{const[t,s]=we();return(0,X.jsxs)("section",{className:O,ref:s,children:[(0,X.jsx)(l.C,{as:"h2",variant:"alto",className:Fe,charCount:25,isLoading:!0}),(0,X.jsx)("div",{className:A,style:t.cssProperties,children:[...new Array(e).keys()].slice(0,6).map(((e,t)=>(0,X.jsx)(Ae,{isLoading:!0},t)))})]})}));var Me=s(4763),He=s(17702),Re=s(83600),ze=s(33428),Ge=s(46213),We=s(49411);const Ze=()=>(0,Re.W6)(ze.Jw)===ze.pF.ONHOME?(0,X.jsx)(Ge.w,{children:(0,X.jsx)(We.M,{onSearch:!1})}):null;var qe=s(26724),Je=s(12938),Ye=s(89688),$e=s(49302),Ke=s(383),Ve=s(46958),Xe=s(89613),Qe=s(42817),et=s(7184),tt=s(94576);const st=({spec:e,section:t,index:s})=>{const i=(0,Re.W6)(ze.ty,{loadingValue:!1})?Qe.N:et.q;return(0,n.useMemo)((()=>t.sectionItems.items.some((e=>(0,tt.d)(e.content)))),[t.sectionItems])?(0,X.jsx)(re.Nh,{spec:e.shelvesFactory(),children:(0,X.jsx)(i,{total:t.sectionItems.totalCount,seeAllUri:t.uri,pageId:t.uri,title:t.data.title?.text??"",index:s,id:t.uri,children:t.sectionItems.items.map(tt.x)})}):null};var nt=s(47343);const it=({spec:e,section:t,index:s})=>(0,X.jsx)(re.Nh,{spec:e.shelvesFactory(),children:(0,X.jsx)(nt.default,{title:t.data.title?.text??void 0,showAll:!1,index:s})});var ot=s(8701);const at=({spec:e,greeting:t,section:s})=>(0,X.jsx)(re.Nh,{spec:e.shortcutsFactory(),children:(0,X.jsx)(Be,{items:s.sectionItems.items.map(ot.lh),title:t??void 0})}),rt=(0,n.lazy)((async()=>{const{FeatureActivationShelf:e}=await Promise.all([s.e(1814),s.e(8228)]).then(s.bind(s,29679));return{default:e}})),ct=({spec:e,greeting:t,section:s,index:n})=>{switch(s.data?.__typename){case"HomeGenericSectionData":return(0,X.jsx)(st,{spec:e,section:(0,Xe.f)(s,s.data),index:n});case"HomeFeatureActivationSectionData":return(0,Ke.wW)()?(0,X.jsx)(rt,{}):null;case"HomeShortsSectionData":return(0,X.jsx)(at,{spec:e,greeting:t,section:(0,Xe.f)(s,s.data)});case"HomeRecentlyPlayedSectionData":return(0,X.jsx)(it,{spec:e,section:(0,Xe.f)(s,s.data),index:n});case"HomeFeedBaselineSectionData":case"HomeNativeAdsSectionData":case"HomeOnboardingSectionData":case null:case void 0:return null;default:return(0,Ve._)(s.data),null}},lt=({spec:e,greeting:t,container:s})=>{const{spec:i,logger:o}=(0,re.fU)(Ye.createDesktopHomeFeatureActivationShelfEventFactory,{});return(0,n.useEffect)((()=>{(0,$e.wW)()&&o.logImpression(i.impressionElementFactory().impression())}),[i,o]),(0,X.jsx)(X.Fragment,{children:s.sections.items.map(((s,n)=>(0,X.jsx)(ct,{spec:e,greeting:t,section:s,index:n},`${n}-${s.uri}`)))})};var ut=s(89789),mt=s(29127);const dt=(0,n.memo)((({cardCount:e})=>(0,X.jsx)(mt.X,{isLoading:!0,children:[...new Array(e).keys()].map(((e,t)=>(0,X.jsx)(ut.A,{isLoading:!0},t)))})));var ht=s(74798);const xt=6,pt=6,gt=6,jt=(0,n.memo)((({shortcutCount:e,shelfCount:t,cardCount:s})=>(0,X.jsx)("section",{"data-testid":"home-page",children:(0,X.jsx)("div",{className:ht.Z.home,children:(0,X.jsxs)("div",{className:o()(ht.Z.content,"contentSpacing"),children:[(0,X.jsx)(De,{shortcutCount:e}),[...new Array(t).keys()].map(((e,t)=>(0,X.jsx)(dt,{cardCount:s},t)))]})})}))),ft=({spec:e})=>{(0,He.z)("home");const{data:t,error:s,loading:n}=(0,qe.b3)({timeZone:(0,Je.L7)()},{cacheTime:Je.us,staleTime:Je.fS});if(n)return(0,X.jsx)(jt,{shortcutCount:xt,shelfCount:pt,cardCount:gt});if(null!==s)return(0,X.jsx)(Me.h,{hasError:!0,errorMessage:r.ag.get("error.generic")});const i=t?.home;return"HomeResponsePayload"!==i?.__typename||0===i.sectionContainer.sections.totalCount||0===i.sectionContainer.sections.items.length?(0,X.jsx)(Me.h,{hasError:!0,errorMessage:r.ag.get("error.generic")}):(0,X.jsx)("section",{"data-testid":"home-page",children:(0,X.jsx)("div",{className:ht.Z.home,children:(0,X.jsx)("div",{className:o()(ht.Z.content,"contentSpacing"),children:(0,X.jsx)(lt,{spec:e,greeting:i.greeting?.text??null,container:i.sectionContainer})})})})},yt=()=>{const{spec:e}=(0,re.fU)(a.createDesktopHomeEventFactory,{data:{identifier:"home",uri:"spotify:home"}});return(0,X.jsxs)(re.Nh,{spec:e,children:[(0,X.jsx)(c.$,{children:r.ag.get("page.generic-title")}),(0,X.jsx)(n.Suspense,{fallback:null,children:(0,X.jsx)(Ze,{})}),(0,X.jsx)(ft,{spec:e})]})}}}]);
//# sourceMappingURL=home-v2.js.map