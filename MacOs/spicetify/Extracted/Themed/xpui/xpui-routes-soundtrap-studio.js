"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[3780],{22578:(e,t,n)=>{n.d(t,{$:()=>d});n(26699),n(32023),n(69600),n(68309),n(21249);var r=n(64593),o=n(96206),u=n(69691),a=n(8341),c=n(89952),i=n(67294),s=n(51615),l=n(24183),f=n(85893);function p(e){return e.includes("Spotify")?e:"Spotify – ".concat(e)}var d=function(e){var t,n,d,v,h,w,m,g=e.children,k=e.usePlayingItem,I=p(g);t=g,v=(0,l.Oh)().mainLandmarkRef,h=(0,s.k6)(),w=null===(n=h.location)||void 0===n||null===(d=n.state)||void 0===d?void 0:d.preventMoveFocus,(m=(0,i.useRef)(h.length<2)).current=h.length<2,(0,i.useEffect)((function(){var e=v.current;!w&&!m.current&&e&&t&&(e.setAttribute("aria-label",t),e.focus())}),[t,v,w]);var j=(0,u.IK)().isPlaying,b=(0,a.Y)((function(e){return null==e?void 0:e.item}));return b&&(j||k)&&((0,c.G_)(b)?I=[b.name,b.artists.map((function(e){return e.name})).join(o.ag.getSeparator())].join(" • "):(0,c.iw)(b)?I=[b.name,b.show.name].join(" • "):(0,c.k6)(b)&&(I=p(o.ag.get("ad-formats.advertisement")))),(0,f.jsx)(r.q,{defaultTitle:"Spotify",defer:!1,children:(0,f.jsx)("title",{children:I})})}},19207:(e,t,n)=>{n.r(t),n.d(t,{default:()=>U});var r=n(4942),o=n(15861),u=n(29439),a=n(87757),c=n.n(a),i=(n(69600),n(21249),n(92222),n(74916),n(15306),n(67294)),s=n(94184),l=n.n(s),f=n(86706),p=n(51615),d=n(69518),v=n.n(d),h=n(96206),w=n(22578),m=n(6158),g=n(23701),k=n(50709),I=n(67448),j=n(99125),b=n(23716),x=n(8341),y=n(35761);const S="_8NXEiIW8UUvsBVNhHdc",E="pZytOOt4d5hSOwPD8A_V";var P=n(85893);const U=(0,i.memo)((function(){var e=(0,g.n)(),t=(0,p.UO)(),n=t.projectId,a=t.songId,s=(0,i.useRef)(null),d=(0,f.I0)(),U=(0,I.z)(),Z=(0,p.k6)(),O=(0,i.useMemo)((function(){return[["showtippopups",0],["workflow","cover"],["workflowSongId",a]].map((function(e){var t=(0,u.Z)(e,2),n=t[0],r=t[1];return"".concat(n,"=").concat(r)})).join("&")}),[a]),L=(0,f.v9)((function(e){var t;return null===(t=e.session.user)||void 0===t?void 0:t.uri})),_=v().from(L).toURLPath(!0),C=(0,i.useState)(null),M=(0,u.Z)(C,2),R=M[0],V=M[1],z=function(e){var t=e.redirectUri,n=(0,I.z)(),r=(0,i.useState)(""),a=(0,u.Z)(r,2),s=a[0],l=a[1],f=(0,i.useState)(null),p=(0,u.Z)(f,2),d=p[0],v=p[1];return(0,i.useEffect)((function(){(0,o.Z)(c().mark((function e(){var r,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.requestAccountLinkToken();case 3:r=e.sent,o=r.token,l("".concat("https://www.soundtrap.com/spotify/accountlink","/?redirect=").concat(encodeURIComponent(t),"&token=").concat(o)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),v("Something went wrong while trying link your account");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()}),[n,t]),{route:s,error:d}}({redirectUri:"https://www.soundtrap.com/studio/".concat(n,"/?").concat(O)}),A=z.route,B=z.error,N=(0,k.i)(),T=N.resetMainView,q=N.collapseMainView,H=(0,b.g)(),X=(0,x.Y)((function(e){return(null==e?void 0:e.hasContext)&&!(null!=e&&e.isPaused)}));(0,i.useEffect)((function(){var e=s.current;return U.setIframe(e),function(){U.setIframe(null)}}),[s,U,d]),(0,y.I)(j.O.EXIT,(function(){Z.goBack()})),(0,y.I)(j.O.PUBLISH,function(){var e=(0,o.Z)(c().mark((function e(t){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.data,r=!n.title||!n.projectId,V(null),!r){e.next=6;break}return V("Cannot publish project, title or projectId are missing."),e.abrupt("return");case 6:return e.prev=6,e.next=9,U.publish({projectId:n.projectId,title:n.title,isPrivate:!0===n.isPrivate});case 9:Z.replace(_,{referrer:"soundtrap_publish",newProjectId:n.projectId}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(6),V("Something went wrong while trying to publish the project.");case 15:case"end":return e.stop()}}),e,null,[[6,12]])})));return function(t){return e.apply(this,arguments)}}()),(0,i.useEffect)((function(){X&&(null==H||H.pause())}),[X,H]),(0,i.useEffect)((function(){return q(),T}),[]);var Y=null!=B?B:R;return Y?(0,P.jsx)(m.h,{hasError:!0,errorMessage:Y}):(0,P.jsxs)(i.Suspense,{fallback:null,children:[(0,P.jsx)(w.$,{children:h.ag.get("playlist.page-title")}),(0,P.jsx)("iframe",{ref:s,src:A,className:l()(S,(0,r.Z)({},E,e)),allow:"microphone https://www.soundtrap.com/studio;",title:"Soundtrap"})]})}))},35761:(e,t,n)=>{n.d(t,{I:()=>u});var r=n(67294),o=n(67448);function u(e,t){var n=(0,o.z)();(0,r.useEffect)((function(){var r=n.getEvents(),o=function(e){return t(e)};return r.addListener(e,o),function(){r.removeListener(e,o)}}),[e,n,t])}}}]);
//# sourceMappingURL=xpui-routes-soundtrap-studio.js.map