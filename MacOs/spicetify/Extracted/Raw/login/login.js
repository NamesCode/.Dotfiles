(()=>{var e,t={927:e=>{e.exports={af:"af-ZA",am:"am-ET",ar:"ar",az:"az-AZ",bg:"bg-BG",bn:"bn-IN",bho:"bp",cs:"cs-CZ",da:"da-DK",de:"de-DE",el:"el-GR",es:"es-ES","es-419":"es-LA",et:"et-EE",fa:"fa-IR",fr:"fr-FR",fi:"fi-FI",fil:"fp-PH","fr-CA":"fr-CA",gu:"gu-IN",hu:"hu-HU",he:"he-IL",hi:"hi-IN",hr:"hr-HR",id:"id-ID",is:"is-IS",it:"it-IT",ja:"ja-JP",kn:"kn-IN",ko:"ko-KR",lt:"lt-LT",lv:"lv-LV",ml:"ml-IN",mr:"mr-IN",ms:"ms-MY",nb:"nb-NO",ne:"ne-NP",nl:"nl-NL",or:"or-IN","pa-IN":"pa-IN","pa-PK":"pa-PK",pl:"pl-PL","pt-PT":"pt-PT","pt-BR":"pt-BR",ro:"ro-RO",ru:"ru-RU",sk:"sk-SK",sl:"sl-SI",sr:"sr-RS",sv:"sv-SE",sw:"sw",ta:"ta-IN",te:"te-IN",th:"th-TH",tr:"tr-TR",uk:"uk-UA",ur:"ur",vi:"vi-VN","zh-CN":"zh-CN","zh-TW":"zh-TW",zu:"zu-ZA","ar-EG":"ar-EG","ar-MA":"ar-MA","ar-SA":"ar-SA",eu:"eu-ES",bs:"bs-BA",ca:"ca-ES","zh-HK":"zh-HK","en-GB":"en-GB",gl:"gl-ES",mk:"mk-MK","es-AR":"es-AR","es-MX":"es-MX"}},2466:(e,t,n)=>{"use strict";var s={};n.r(s),n.d(s,{ABORT_LOGIN_TYPE_ACCOUNTS:()=>G,ACCOUNTS_METHODS:()=>B,LOADING:()=>F,LOGIN_BEFORE:()=>N,LOGIN_CLEAR_ERRORS:()=>P,LOGIN_FAIL:()=>D,LOGIN_SUCCESS:()=>A,LOGIN_TYPE_ACCOUNTS:()=>U,LOGIN_TYPE_AUTOLOGIN:()=>R,LOGIN_TYPE_EMAIL:()=>M,LOGIN_TYPE_FACEBOOK:()=>L,LOGIN_TYPE_FACEBOOK_POPUP:()=>j,UTM_PARAMETERS:()=>O,abortLoginWithAccounts:()=>z,fetchUTMParameters:()=>X,loading:()=>H,login:()=>Y,loginClearErrors:()=>Q,loginFailed:()=>$,loginSuccess:()=>V,loginWithAccounts:()=>q,loginWithFacebookPopup:()=>J,receivedUTMParameters:()=>Z});var r={};n.r(r),n.d(r,{ENTER_LOGIN_MODE:()=>re,ENTER_SETTINGS_MODE:()=>ie,ENTER_SIGNUP_MODE:()=>te,ENTER_SIGNUP_MODE_STEP_0:()=>ne,ENTER_SIGNUP_MODE_STEP_1:()=>se,ENTER_WELCOME_MODE:()=>oe,INTERACTION:()=>ae,START_APP:()=>ee,enterLoginMode:()=>pe,enterSettingsMode:()=>he,enterSignupMode:()=>de,enterSignupModeStep0:()=>ce,enterSignupModeStep1:()=>ue,enterWelcomeMode:()=>ge,interaction:()=>_e,openSignupPage:()=>me,startApp:()=>le});var o={};n.r(o),n.d(o,{CLEAR_ALL_ERRORS:()=>Ue,COUNTRY_NOT_LAUNCHED:()=>Re,FACEBOOK_SIGNUP_ATTEMPT:()=>Pe,FACEBOOK_SIGNUP_FAILURE:()=>Fe,FACEBOOK_SIGNUP_SUCCESS:()=>De,SIGNUP_ATTEMPT:()=>Ie,SIGNUP_FAILURE:()=>Ne,SIGNUP_RESTRICTIONS_FAILURE:()=>Te,SIGNUP_RESTRICTIONS_SUCCESS:()=>xe,SIGNUP_SUCCESS:()=>Ae,UPDATE_SIGNUP_DATA:()=>je,VALIDATE_FIELD_ATTEMPT:()=>Oe,VALIDATE_FIELD_FAILURE:()=>Me,VALIDATE_FIELD_SUCCESS:()=>Le,clearAllErrors:()=>st,countryNotLaunched:()=>nt,facebookSignup:()=>ze,facebookSignupFailure:()=>Xe,facebookSignupSuccess:()=>Je,getSignupRestrictions:()=>Ge,signup:()=>Ve,signupAttempt:()=>He,signupFailure:()=>Ye,signupRestrictionsFailure:()=>We,signupRestrictionsSuccess:()=>Be,signupSuccess:()=>Ke,signupWithAccounts:()=>qe,updateSignupData:()=>tt,validateField:()=>$e,validateFieldAttempt:()=>Ze,validateFieldFailure:()=>Qe,validateFieldSuccess:()=>et});var i={};n.r(i),n.d(i,{SETTINGS_FETCH_PROXY_SETTINGS_FAILURE:()=>yt,SETTINGS_FETCH_PROXY_SETTINGS_SUCCESS:()=>St,SETTINGS_RESTART_CLIENT_FAILURE:()=>Ct,SETTINGS_RESTART_CLIENT_SUCCESS:()=>wt,SETTINGS_UPDATE_PROXY_SETTINGS_FAILURE:()=>kt,SETTINGS_UPDATE_PROXY_SETTINGS_SUCCESS:()=>Et,fetchProxySettings:()=>vt,restartClient:()=>Tt,updateProxySettings:()=>xt});var a=n(7995),l=n(3742),d=n(7646),c=n(890),u=n(6286);const p=e=>n.g&&"function"==typeof n.g._getSpotifyModule?new Promise(((t,s)=>{n.g._getSpotifyModule("bridge").executeRequest(JSON.stringify(e),{onSuccess:t,onFailure:s})})):null,g="https://www.spotify.com/redirect/account-page/",h="showSettings",m={id:"UnknownLoginErrorMessage"},_={id:"DefaultErrorMessage",replace:[h]},f={id:"FbFailureOpenPopup",silent:!0},b={127:{id:"SessionTerminatedMessage"},3:{id:"BadCredentialsMessage"},4:{id:"ErrorResolvingDNS"},53:{id:"ErrorProxyUnauthorized"},54:{id:"ErrorProxyForbidden"},55:{id:"ErrorProxyAuthRequired",replace:[h]},400:m,401:m,402:{id:"CriticalUpdate"},403:{id:"UserBannedMessage"},404:m,405:m,406:{id:"UserNotAllowedOnPlatformMessage"},407:{id:"MissingUserInfoMessage",replace:[g]},408:{id:"RegionMismatchMessage",replace:[g,"https://www.spotify.com/redirect/upgrade-product/"]},409:{id:"PremiumUsersOnlyMessage"},410:{id:"BadCredentialsMessage"},411:m,412:{id:"BadCredentialsMessage"},413:{id:"CreateUserDeniedMessage"},414:m,415:m,416:m,417:{id:"FacebookCredentialsMisusedMessage"},418:m,"critical-update-error":{id:"ClientUpdateFail",replace:["https://www.spotify.com/redirect/download/"]},1001:{silent:!0},1002:f,1003:{id:"FbUserNotFoundSignUp",replace:["showSignup"]},1004:f,1005:f,1006:f},S={1:m,2:m,3:{id:"BadCredentialsMessage"},4:m,5:m,6:m,7:m,8:m,9:m},y={1:{silent:!0},2:m,3:m,4:{id:"SessionExpiredMessage"},5:_},E=window.localStorage,k="lastUsername",w="THIS_USER_DOES_NOT_EXIST_AND_IS_A_PLACEHOLDER",C="utmParameters",v=E.getItem(C),x=E.getItem(k),T={errorData:null,loginInProgress:!1,redirectTo:null,username:x!==w?x:"",utmParameters:v?JSON.parse(v):null};const I=function(e=T,t){switch(t.type){case It.LOADING:return{...e,loading:!0,throbberDelay:t.throbberDelay};case It.LOGIN_FAIL:return{...e,loading:!1,errorData:t.errorData,loggedIn:!1,loginInProgress:!1};case It.LOGIN_BEFORE:return{...e,errorData:t.errorData,loggedIn:!1,loginInProgress:t.loginInProgress,username:t.username};case It.LOGIN_SUCCESS:return{...e,loading:!1,loggedIn:!0,redirectDelay:t.redirectDelay||0,redirectTo:t.redirectTo,username:t.username};case It.UTM_PARAMETERS:return{...e,utmParameters:t.utmParameters};case It.LOGIN_CLEAR_ERRORS:return{...e,errorData:null};default:return e}},N="LOGIN_BEFORE",A="LOGIN_SUCCESS",P="LOGIN_CLEAR_ERRORS",D="LOGIN_FAIL",F="LOADING",O="UTM_PARAMETERS",M="login",L="login-facebook",j="login-facebook-popup",R="autologin",U="login-accounts",G="abort-login-accounts",B={facebook:"facebook",apple:"apple",google:"google"};function W(e,t=M){return{type:N,errorData:null,username:e||"",loginInProgress:t===M,loginType:t}}function V(e,t,n=M,s=!1,r){return{type:A,errorData:null,redirectTo:r,redirectDelay:t||0,username:e,loginType:n,afterSignup:s}}function $(e,t=M){return{type:D,errorData:e,loginType:t}}function H(e){return{type:F,throbberDelay:e&&e.throbberDelay?e.throbberDelay:0}}const K=async(e,t,{defaultErrorCode:n,redirectDelay:s=0}={},r=M,o=!1,i=null,a=!0)=>{i&&(t.args=t.args||[],t.args[0]=t.args[0]||{},t.args[0].actionHash=i);try{const n=JSON.parse(await p(t)).redirectTo||"xpui";let i=null;t&&t.args&&t.args[0]&&(i=t.args[0].username),e(V(a?i:w,s,r,o,n))}catch(t){let s=t;n?s={errorCode:n}:"string"==typeof t&&(s=JSON.parse(t)),s.errorCode&&b[s.errorCode]&&"FbFailureOpenPopup"===b[s.errorCode].id?e(J(i)):e($(s,r))}};function Y({username:e,password:t,rememberMe:n},s=!1,r=null){return o=>{const i=s?R:M;o(W(n?e:w,i));K(o,{name:M,args:[{username:e,password:t,rememberMe:n}]},{redirectDelay:200},i,s,r,n)}}function q(e,t){return n=>{n(W(null,U));K(n,{name:U,args:[{method:e,enableSignup:!1}]},{redirectDelay:200},U,!1,t)}}function z(){return async()=>{await p({name:G,args:[]})}}function J(e=null){return t=>{t(W(null,L));K(t,{name:j,args:[]},{redirectDelay:200},L,!1,e)}}function X(){return async e=>{e(Z(JSON.parse(await p({name:"get-signup-utm-parameters",args:[]}))))}}function Z(e){return{type:O,utmParameters:e}}function Q(){return{type:P}}const ee="START_APP",te="ENTER_SIGNUP_MODE",ne="ENTER_SIGNUP_MODE_STEP_0",se="ENTER_SIGNUP_MODE_STEP_1",re="ENTER_LOGIN_MODE",oe="ENTER_WELCOME_MODE",ie="ENTER_SETTINGS_MODE",ae="INTERACTION";function le(){return{type:ee}}function de(e=null){return{type:te,actionHash:e}}function ce(){return{type:ne}}function ue(){return{type:se}}function pe(e=null){return{type:re,actionHash:e}}function ge(e=null){return{type:oe,errorMessage:e}}function he(){return{type:ie}}function me(e=!1){return async(t,n)=>{let s,r={};switch(e?"website":"desktop-app"){case"desktop-app":t(de());break;case"website":{await t(X());const e=n();r=e.login.utmParameters||{utm_source:"spotify",utm_medium:"desktop-unknown",utm_campaign:"organic",referral:""};const o=Object.keys(r).reduce(((e,t)=>(e[t]=encodeURIComponent(r[t]),e)),{});s=`https://www.spotify.com/signup?utm_source=${o.utm_source}&utm_medium=${o.utm_medium}&utm_campaign=${o.utm_campaign}`,o.referral&&(s+=`&referral=${o.referral}&referrer=${o.referral}`),window.open(s);break}}}}function _e(e,t,n,s,r){return{type:ae,page:e,interactionType:t,intent:n,itemId:s,actionHash:r}}var fe=n(8961),be=n.n(fe);function Se(){const e="undefined"!=typeof window&&window.__spotify&&window.__spotify.DESKTOP_SIGNUP_DEBUG_KEY;return e||"4c7a36d5260abca4af282779720cf631"}function ye(){const e="undefined"!=typeof window&&window.__spotify&&window.__spotify.client_version||"";if(!e)throw new Error("Missing Spotify App Version! Something is wrong: talk to #desktop-squad.");return["Spotify-App-Version",e]}function Ee(){const e="undefined"!=typeof window&&window.navigator&&window.navigator.platform||"";let t="";if(-1!==e.indexOf("Mac")?t="OSX":-1!==e.indexOf("Win")?t="Win32":-1!==e.indexOf("Linux")&&(t="Linux"),!t)throw new Error("Missing App Platform! Something is wrong: talk to #desktop-squad.");return["App-Platform",t]}function ke(e){const t=new Map(Object.entries(e).sort()),n=function(e){const t=be().create();return e.forEach((e=>{void 0!==e&&t.update(e.toString())})),t.hex()}(t);if(t.size>n.length)return t;const s=[...t],r=[...Array(t.size).keys()].sort((function(e,t){const r=n.charAt(e).localeCompare(n.charAt(t));return 0!==r?r:s[e][0].localeCompare(s[t][0])})),o=new Map;return r.forEach((function(e){o.set(s[e][0],s[e][1])})),o}const we=e=>async(t,n,s)=>{const r=function({name:e,email:t,password:n,gender:s,birthDate:r={},sendEmail:o,shareData:i,agreeEula:a}={},l={utm_source:"spotify",utm_medium:"desktop-unknown",utm_campaign:"organic",referral:""},d=!1){const c=Object.keys(l).reduce(((e,t)=>(e[t]=encodeURIComponent(l[t]),e)),{});let u=`https://login.app.spotify.com?utm_source=${c.utm_source}&utm_medium=${c.utm_medium}&utm_campaign=${c.utm_campaign}`;c.referral&&(u+=`&referral=${c.referral}&referrer=${c.referral}`);const p={key:Se(),displayname:e,email:t,password:n,password_repeat:n,gender:s,birth_year:r.year,birth_month:r.month,birth_day:r.day,iagree:a?1:0,creation_point:u,creation_flow:"desktop",platform:"desktop",referrer:c.referral};return"boolean"==typeof o&&(p["send-email"]=o),"boolean"==typeof i&&(p.thirdpartyemail=i),d&&Object.keys(p).forEach((e=>{void 0===p[e]&&delete p[e]})),ke(p)}(t,n,s),o=new FormData;r.forEach(((e,t)=>{o.append(t,e)}));const i=[ye(),Ee()].reduce(((e,t)=>(e[t[0]]=t[1],e)),{}),a={method:"POST",body:o,headers:{"App-Platform":i["App-Platform"],"Spotify-App-Version":i["Spotify-App-Version"],"X-Client-Id":{}.SPOTIFY_CLIENT_ID}},l=new Request(e,a);((e,t)=>{const n=e.headers.get("content-type");e.headers.set("content-type",((e,t)=>[...e.split(";"),t].join(";"))(n,t))})(l,"charset=utf-8");const d=await fetch(l),{errors:c,...u}=await d.json()||{};if(c)throw c;return u},Ce=we("https://spclient.wg.spotify.com/signup/public/v1/account/"),ve=we("https://spclient.wg.spotify.com/signup/public/v1/account/?validate=true");const xe="SIGNUP_RESTRICTIONS_SUCCESS",Te="SIGNUP_RESTRICTIONS_FAILURE",Ie="SIGNUP_ATTEMPT",Ne="SIGNUP_FAILURE",Ae="SIGNUP_SUCCESS",Pe="FACEBOOK_SIGNUP_ATTEMPT",De="FACEBOOK_SIGNUP_SUCCESS",Fe="FACEBOOK_SIGNUP_FAILURE",Oe="VALIDATE_FIELD_ATTEMPT",Me="VALIDATE_FIELD_FAILURE",Le="VALIDATE_FIELD_SUCCESS",je="UPDATE_SIGNUP_DATA",Re="COUNTRY_NOT_LAUNCHED",Ue="CLEAR_ALL_ERRORS";function Ge(){return async(e,t)=>{const n=t();try{e(Be(window.__spotify&&!0===window.__spotify.is_running_on_teamcity?{}:await(async()=>{const e=await fetch("https://spclient.wg.spotify.com/signup/public/v1/account/?validate=1"),t=await e.json()||{};if(t.errors&&t.errors.length>0)throw t.errors;return t})()))}catch(t){e(We(t)),n.app&&n.app.mode&&"welcome"!==n.app.mode&&(e(pe()),e(me(!0)))}}}function Be(e){return{type:xe,restrictions:e}}function We(e){return{type:Te,error:e}}function Ve(e=null){return async(t,n)=>{t(He()),await t(X());const s=n().signup.formData,r=n().login.utmParameters;try{await Ce(s,r),t(Ke());const{email:n,password:o}=s;t(Y({username:n,password:o,rememberMe:!0},!0,e))}catch(e){const n={};Object.keys(e).forEach((t=>{n["birthdate"===t?"birthDate":t]={message:e[t]}})),t(Ye(n))}}}function $e(e){return async(t,n)=>{await t(X());const s=n().signup.formData[e],r=n().login.utmParameters;t(Ze(e,s));try{await ve({[e]:s},r,!0)}catch(n){n[e]&&t(Qe(e,{message:n[e]}))}}}function He(){return{type:Ie}}function Ke(){return{type:Ae}}function Ye(e){return{type:Ne,errors:e}}function qe(e,t=null){return n=>{const s={name:U,args:[{method:e,enableSignup:!0}]};n(ze()),(async(e,t,n=null)=>{n&&(t.args=t.args||[],t.args[0]=t.args[0]||{},t.args[0].actionHash=n);try{const n=JSON.parse(await p(t)).redirectTo||"xpui";e(Je()),e(V(null,0,R,!0,n))}catch(t){let n=t;"string"==typeof t&&(n=JSON.parse(t)),e(Xe(n))}})(n,s,t)}}function ze(){return{type:Pe}}function Je(){return{type:De}}function Xe(e){return{type:Fe,errorData:e}}function Ze(e,t){return{type:Oe,field:e,value:t}}function Qe(e,t){return{type:Me,field:e,error:t}}function et(e){return{type:Le,field:e}}function tt(e){return{type:je,data:e}}function nt(){return{type:Re}}function st(){return{type:Ue}}var rt=n(927),ot=n.n(rt);let it,at,lt;!function(e){e.af="af",e.am="am",e.ar="ar",e.az="az",e.bg="bg",e.bn="bn",e.bho="bho",e.ca="ca",e.cs="cs",e.da="da",e.de="de",e.el="el",e.en="en",e.es419="es-419",e.es="es",e.et="et",e.fa="fa",e.fi="fi",e.fil="fil",e.frCA="fr-CA",e.fr="fr",e.gu="gu",e.he="he",e.hi="hi",e.hr="hr",e.hu="hu",e.id="id",e.is="is",e.it="it",e.ja="ja",e.kn="kn",e.ko="ko",e.lt="lt",e.lv="lv",e.ml="ml",e.mr="mr",e.ms="ms",e.nb="nb",e.ne="ne",e.nl="nl",e.or="or",e.paIN="pa-IN",e.paPK="pa-PK",e.pl="pl",e.ptBR="pt-BR",e.ptPT="pt-PT",e.ro="ro",e.ru="ru",e.sk="sk",e.sl="sl",e.sr="sr",e.sv="sv",e.sw="sw",e.ta="ta",e.te="te",e.th="th",e.tr="tr",e.uk="uk",e.ur="ur",e.vi="vi",e.zhCN="zh-CN",e.zhTW="zh-TW",e.zu="zu"}(it||(it={})),function(e){e.AR="، ",e.FA="، ",e.EN=", "}(at||(at={})),function(e){e.ZERO="zero",e.ONE="one",e.TWO="two",e.FEW="few",e.MANY="many",e.OTHER="other"}(lt||(lt={}));let dt={};function ct(e){return"number"==typeof e?e.toString():e.replace(/\$/,"$$$$")}const ut=e=>"ar"===e?"ar-u-nu-latn":e;const pt=new class{_relativeTimeFormat=void 0===Intl.RelativeTimeFormat?null:new Intl.RelativeTimeFormat;_dateTimeFormats=new Map;constructor(){this._dictionary={},this._locale=it.en}getDateTimeFormat(e){const t=JSON.stringify(Object.keys(e).sort().map((t=>({[t]:e[t]}))));let n=this._dateTimeFormats.get(t);return void 0===n&&(n=new Intl.DateTimeFormat(ut(this._locale),e),this._dateTimeFormats.set(t,n)),n}getDictionary(){return this._dictionary}setDictionary(e){this._dictionary=e}setLocale(e){this._locale=e,this._dateTimeFormats.clear()}getLocale(){return this._locale}getSmartlingLocale(){const e=this._locale;return ot()[e]||e}toLocaleLowerCase(e){return e?.toLocaleLowerCase(this._locale)}toLocaleUpperCase(e){return e?.toLocaleUpperCase(this._locale)}get(e,...t){const n=e in this._dictionary?this._dictionary[e]:e;let s="";if("string"!=typeof n){const e=t[0],r=((e,t)=>{try{return(dt[e]||(dt[e]=new Intl.PluralRules(e))).select(t)}catch{return lt.OTHER}})(this._locale,parseInt(e,10)),o=n[r];void 0!==o?s=o:n.other&&(s=n.other)}else s=n;if(/%\d%/.test(s)){if(!["desktop.login.DefaultErrorMessage","desktop.login.ErrorProxyAuthRequired","desktop.login.MissingUserInfoMessage","desktop.login.RegionMismatchMessage","desktop.login.ClientUpdateFail","desktop.login.FbUserNotFoundSignUp","desktop-auth.error"].includes(e))throw new Error("i18n: The placeholder format %0% is legacy and is only allowed for existing strings.")}if(t?.length>0)for(let e=0;e<t.length;e++){const n=t[e];if(null!=n)if("string"==typeof n)s=s.replace(`{${e}}`,ct(n)).replace(`%${e}%`,ct(n));else if("number"==typeof n){const t=this.formatNumber(n);s=s.replace(`{${e}}`,t).replace(`%${e}%`,t)}else if("object"==typeof n)for(const e of Object.keys(n)){const t=n[e];s=s.replace(`%${e}%`,ct(t))}}return s}getSeparator(){switch(this._locale){case it.ar:return at.AR;case it.fa:return at.FA;default:return at.EN}}formatNumber(e,t){return e.toLocaleString(ut(this._locale),t)}formatNumberCompact(e){return this.formatNumber(e,{notation:"compact",maximumFractionDigits:1})}formatDate(e,t=null){const n=t||{year:"numeric",month:"long",day:"numeric"};return this.getDateTimeFormat(n).format(e)}formatRelativeDate(e,t=null){const n=new Date(Date.now()),s=(e=new Date(e)).getTime()-n.getTime();if(Math.abs(s)<2592e6&&null!==this._relativeTimeFormat){const{days:e,hours:t,minutes:n,seconds:o}=(r=s,{seconds:Math.round(r/1e3),minutes:Math.round(r/1e3/60),hours:Math.round(r/1e3/60/60),days:Math.round(r/1e3/60/60/24)});return e||t||n?e||t?e?this._relativeTimeFormat.format(e,"days"):this._relativeTimeFormat.format(t,"hours"):this._relativeTimeFormat.format(n,"minutes"):this._relativeTimeFormat.format(o,"seconds")}var r;return this.formatDate(e,t)}__resetForTests(){this._dictionary={},this._locale=it.en,dt={}}},gt=2,ht=3,mt=4,_t={"auto-detect":{label:()=>pt.get("desktop.settings.proxy.autodetect")},"no-proxy":{label:()=>pt.get("desktop.settings.proxy.noproxy")},http:{label:()=>pt.get("desktop.settings.proxy.http")},socks4:{label:()=>pt.get("desktop.settings.proxy.socks4")},socks5:{label:()=>pt.get("desktop.settings.proxy.socks5")}},ft=[{enumKey:"auto-detect",enumValue:0},{enumKey:"no-proxy",enumValue:1},{enumKey:"http",enumValue:2},{enumKey:"socks4",enumValue:3},{enumKey:"socks5",enumValue:4}],bt="sp://proxy/v1/";const St="SETTINGS_FETCH_PROXY_SETTINGS_SUCCESS",yt="SETTINGS_FETCH_PROXY_SETTINGS_FAILURE",Et="SETTINGS_UPDATE_PROXY_SETTINGS_SUCCESS",kt="SETTINGS_UPDATE_PROXY_SETTINGS_FAILURE",wt="SETTINGS_RESTART_CLIENT_SUCCESS",Ct="SETTINGS_RESTART_CLIENT_FAILURE";function vt(){return e=>{(async function(){return new Promise(((e,t)=>{window.sendCosmosRequest({request:JSON.stringify({method:"GET",uri:bt}),persistent:!1,onSuccess:n=>{const s=JSON.parse(n);200!==s.status&&t(new Error(`Failed to fetch proxy settings (status code: ${s.status})`));const r=JSON.parse(s.body);e({mode:r["network.proxy.mode"],address:r["network.proxy.addr"],username:r["network.proxy.user"],password:r["network.proxy.pass"]})},onFailure:(e,n)=>{t(e)}})}))})().then((t=>{e(function(e){return{type:St,data:e}}(t))}),(t=>{e(function(e){return{type:yt,error:e}}(t))}))}}function xt(e){return t=>{(async function(e){return new Promise(((t,n)=>{const s={"network.proxy.mode":e.mode};[gt,ht,mt].includes(e.mode)&&(s["network.proxy.addr"]=e.address,s["network.proxy.user"]=e.username),[gt,mt].includes(e.mode)&&(s["network.proxy.pass"]=e.password),window.sendCosmosRequest({request:JSON.stringify({method:"PUT",uri:bt,body:JSON.stringify(s)}),persistent:!1,onSuccess:()=>{t()},onFailure:(e,t)=>{n(e)}})}))})(e).then((()=>{t({type:Et}),t(vt())}),(e=>{t(function(e){return{type:kt,error:e}}(e))}))}}function Tt(){return e=>{(async function(){return new Promise(((e,t)=>{window.sendCosmosRequest({request:JSON.stringify({method:"POST",uri:"sp://desktop/v1/restart"}),persistent:!1,onSuccess:()=>{e()},onFailure:(e,n)=>{t(e)}})}))})().then((()=>{e({type:wt})}),(t=>{e(function(e){return{type:Ct,error:e}}(t))}))}}const It={...r,...s,...o,...i};n(9036);var Nt=n(9496),At=n(4637);class Pt extends Nt.Component{constructor(e){super(e),this.state={hidden:this.props.delay>0}}componentDidMount(){!0===this.state.hidden&&(this.throbberTimeout=setTimeout((()=>{this.setState({hidden:!1})}),this.props.delay))}componentWillUnmount(){this.throbberTimeout&&clearTimeout(this.throbberTimeout)}render(){return this.state.hidden?null:(0,At.jsx)("div",{"data-testid":"glue-throbber",className:"GlueThrobber "+(this.props.initial?"throbber-initial":"throbber"),children:(0,At.jsx)("div",{})})}}Pt.defaultProps={delay:0,initial:!0};var Dt=n(5530),Ft=n.n(Dt);function Ot(){return Ft().create().toString()}var Mt=n(492),Lt=n(7155);class jt extends Nt.PureComponent{constructor(e){super(e),this.handleLoginClick=this.handleLoginClick.bind(this),this.handleErrorClick=this.handleErrorClick.bind(this)}handleLoginClick(){const e=Ot();this.props.openLoginPage(e),this.props.onInteraction("login/welcome","click","open-page-login",null,e)}handleErrorClick(e){if(e.target.getAttribute("data-action")){"showSettings"===e.target.getAttribute("data-action")&&this.props.openSettingsPage()}}render(){const{errorMessage:e}=this.props;return(0,At.jsxs)("main",{className:"Welcome","data-testid":"welcome",children:[(0,At.jsxs)("h1",{className:"HeroText __welcome",children:[pt.get("desktop-auth.login.millions-of-songs"),(0,At.jsx)("br",{}),pt.get("desktop-auth.login.free-on-spotify")]}),(0,At.jsxs)("div",{className:"Welcome__signup-or-login",children:[e&&(0,At.jsxs)("div",{className:"Welcome__error-message",role:"alert",onClick:this.handleErrorClick,"aria-live":"assertive",children:[(0,At.jsx)(Mt.l,{className:"Welcome__error-message__icon"}),(0,At.jsx)("span",{dangerouslySetInnerHTML:{__html:e}})]}),(0,At.jsx)(Lt.D,{id:"login-button",onClick:this.handleLoginClick,"data-ta-id":"welcome-login-button","data-testid":"login-button",fullWidth:!0,children:pt.get("desktop.login.LoginButton")})]})]})}}const Rt=(0,d.$j)((e=>({errorMessage:e.app.errorMessage})),(e=>({openLoginPage:t=>e(It.enterLoginMode(t)),openSettingsPage:()=>e(It.enterSettingsMode()),onInteraction:(t,n,s,r,o)=>e(It.interaction(t,n,s,r,o))})))(jt);var Ut=n(8778);function Gt(e,t,n){if(0===t)return!1;if(!e&&!t)return!1;let s=b;switch(e){case"session":s=S;break;case"desktop_login_accounts":s=y}const r=s[t]||_;if(r.silent)return!1;const o=r.replace||[];let i="";switch(r.id){case"UnknownLoginErrorMessage":i=pt.get("desktop.login.UnknownLoginErrorMessage");break;case"DefaultErrorMessage":i=pt.get("desktop.login.DefaultErrorMessage",o[0]);break;case"SessionTerminatedMessage":i=pt.get("desktop.login.SessionTerminatedMessage");break;case"SessionExpiredMessage":i=pt.get("desktop.login.SessionExpiredMessage");break;case"BadCredentialsMessage":i=pt.get("desktop.login.BadCredentialsMessage");break;case"ErrorResolvingDNS":i=pt.get("desktop.login.ErrorResolvingDNS");break;case"ErrorProxyUnauthorized":i=pt.get("desktop.login.ErrorProxyUnauthorized");break;case"ErrorProxyForbidden":i=pt.get("desktop.login.ErrorProxyForbidden");break;case"ErrorProxyAuthRequired":i=pt.get("desktop.login.ErrorProxyAuthRequired",o[0]);break;case"CriticalUpdate":i=pt.get("desktop.login.CriticalUpdate");break;case"UserBannedMessage":i=pt.get("desktop.login.UserBannedMessage");break;case"UserNotAllowedOnPlatformMessage":i=pt.get("desktop.login.UserNotAllowedOnPlatformMessage");break;case"MissingUserInfoMessage":i=pt.get("desktop.login.MissingUserInfoMessage",o[0]);break;case"RegionMismatchMessage":i=pt.get("desktop.login.RegionMismatchMessage",o[0],o[1]);break;case"PremiumUsersOnlyMessage":i=pt.get("desktop.login.PremiumUsersOnlyMessage");break;case"CreateUserDeniedMessage":i=pt.get("desktop.login.CreateUserDeniedMessage");break;case"ClientUpdateFail":i=pt.get("desktop.login.ClientUpdateFail",o[0]);break;case"FbUserNotFoundSignUp":i=pt.get("desktop.login.FbUserNotFoundSignUp",o[0])}return n?`${i}<br>${pt.get("desktop.login.errorCode",n)}`:i}function Bt({validity:e={}}){return e.valid?null:["valueMissing","typeMismatch","tooShort"].find((t=>e[t]))}const Wt="H5vfurs7KNEs9Io5DUA7",Vt="qfBRU_bttJde7gy46oAB",$t="ypTrzM1PtlrZp04qs6Eq",Ht="oHZmDpK0SrWDaXhPjUtC",Kt="lAHowB9HYfAUrg9UaSde";var Yt=n(2679);const qt=Ft().create().toString(),zt="has-used-app",Jt=!window.localStorage.getItem(zt);Jt&&window.localStorage.setItem(zt,!0);const Xt=()=>{const e=E.getItem("utmParameters");let t;try{t=e?JSON.parse(e).referral:""}catch(e){t=""}return t};class Zt{constructor(e){this._eventSender=e}logPageView({page:e}){this.logAction({page:e,action_type:"pageview",action_intent:""})}logAction({page:e,action_type:t,action_intent:n,item_id:s,action_hash:r},o){this._eventSender.send((0,Yt.e)({action_type:t,action_intent:n,action_page:e,action_item_id:s,action_hash:r,device_is_new_install:Jt,device_locale:window.__spotify.locale,device_referrer:Xt(),ab_flags:"",session_id:qt}),o)}}var Qt;!function(e){e[e.SUCCESS=0]="SUCCESS",e[e.OPERATION_ABORTED=1]="OPERATION_ABORTED",e[e.OPERATION_TIMED_OUT=2]="OPERATION_TIMED_OUT",e[e.LOGIN_BAD_CREDENTIALS=3]="LOGIN_BAD_CREDENTIALS",e[e.LOGIN_BAD_APP_KEY=4]="LOGIN_BAD_APP_KEY",e[e.LOGIN_BAD_CLIENT_VERSION_INFO=5]="LOGIN_BAD_CLIENT_VERSION_INFO",e[e.STORAGE_INITIALIZATION_FAILED=6]="STORAGE_INITIALIZATION_FAILED",e[e.MULTIPLE_LOGIN_NOT_ALLOWED=7]="MULTIPLE_LOGIN_NOT_ALLOWED",e[e.OPERATION_CANCELLED=8]="OPERATION_CANCELLED",e[e.BAD_DEVICE_INFO=9]="BAD_DEVICE_INFO",e[e.INTERNAL_ERROR=10]="INTERNAL_ERROR"}(Qt||(Qt={}));const en=function({eventSender:e}){const[t,n]=(0,Nt.useState)(""),[s,r]=(0,Nt.useState)(!1),[o,i]=(0,Nt.useState)(!1),a=function(){const e=(0,d.I0)();return()=>{e(he())}}(),l=(0,Nt.useRef)(0),c=(0,Nt.useMemo)((()=>new Zt(e)),[e]);(0,Nt.useEffect)((()=>{c.logPageView({page:"auth-on-web"})}),[c]);const u=async t=>{const s=++l.current,o=Ot();i(t),n(""),r(!0),c.logAction({page:"auth-on-web",action_type:"click",action_intent:t?"sign-up-with-browser":"log-in-with-browser",action_hash:o});try{await p({name:U,args:[{method:"login-accounts",enableSignup:t,actionHash:o}]}),c.logAction({page:"auth-on-web",action_type:"view",action_intent:t?"show-success-signup":"show-success-login"},{flush:!1}),await e.finalFlush(),location.href="spotify:app:xpui"}catch(e){const o="string"==typeof e?JSON.parse(e):e;if(s!==l.current)return void c.logAction({page:"auth-on-web",action_type:"view",action_intent:t?"sign-up-with-browser-cancelled-by-new-attempt":"log-in-with-browser-cancelled-by-new-attempt",item_id:o?.errorReference});r(!1);let i=Gt(o.errorCategory,o.errorCode,o.errorReference);"desktop_login_accounts"===o.errorCategory&&o.errorCode===Qt.OPERATION_TIMED_OUT&&(i=t?pt.get("desktop-auth.login.signup-time-out"):pt.get("desktop-auth.login.login-time-out")),n(i||""),c.logAction({page:"auth-on-web",action_type:"view",action_intent:t?"show-error-signup":"show-error-login",item_id:o?.errorReference})}};return(0,At.jsx)("main",{children:s?(0,At.jsxs)(At.Fragment,{children:[(0,At.jsx)(Ut.D,{as:"h1",variant:"alto",semanticColor:"textBase",className:Wt,children:o?pt.get("desktop-auth.login.go-to-browser-signup"):pt.get("desktop-auth.login.go-to-browser-login")}),(0,At.jsxs)("button",{className:$t,onClick:()=>{r(!1),c.logAction({page:"auth-on-web",action_type:"click",action_intent:"try-again"})},children:[(0,At.jsx)(Ut.D,{as:"span",variant:"ballad",semanticColor:"textSubdued",children:pt.get("desktop-auth.login.not-seeing-browser")})," ",(0,At.jsx)(Ut.D,{as:"span",variant:"balladBold",semanticColor:"textBase",children:pt.get("desktop-auth.login.try-again")})]})]}):(0,At.jsxs)(At.Fragment,{children:[(0,At.jsxs)(Ut.D,{as:"h1",variant:"alto",semanticColor:"textBase",className:Wt,children:[pt.get("desktop-auth.login.millions-of-songs"),(0,At.jsx)("br",{}),pt.get("desktop-auth.login.free-on-spotify")]}),t&&(0,At.jsxs)("div",{className:Ht,role:"alert",onClick:e=>{if(e.currentTarget.getAttribute("data-action")){"showSettings"===e.currentTarget.getAttribute("data-action")&&a()}},"aria-live":"assertive",children:[(0,At.jsx)(Mt.l,{className:Kt}),(0,At.jsx)("span",{dangerouslySetInnerHTML:{__html:t}})]}),(0,At.jsx)(Lt.D,{onClick:()=>{u(!1)},fullWidth:!0,children:pt.get("desktop-auth.login.log-in-with-browser")}),(0,At.jsxs)("button",{className:Vt,onClick:()=>{u(!0)},children:[(0,At.jsx)(Ut.D,{as:"span",variant:"ballad",semanticColor:"textSubdued",children:pt.get("desktop-auth.login.new-to-spotify")})," ",(0,At.jsx)(Ut.D,{as:"span",variant:"balladBold",semanticColor:"textBase",children:pt.get("desktop-auth.login.sign-up-with-browser")})]})]})})};n(817);var tn=n(8777),nn=n(7381),sn=n(3037),rn=n(4875),on=n.n(rn);const an=()=>(0,At.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,At.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 8C0 3.58172 3.58172 0 8 0C12.4183 0 16 3.58172 16 8C16 12.4183 12.4183 16 8 16C3.58172 16 0 12.4183 0 8ZM7.25 3V10H8.75V3H7.25ZM7.25 11.5256V13.0256H8.75V11.5256H7.25Z",fill:"#eb6471"})});class ln extends Nt.PureComponent{render(){const{errorMessage:e}=this.props;return(0,At.jsxs)("div",{"aria-live":"polite",className:on()("FieldError",{"FieldError--hidden":!e}),children:[(0,At.jsx)(an,{}),(0,At.jsx)("span",{children:e||""})]})}}let dn=0;class cn extends Nt.PureComponent{constructor(...e){super(...e),this.idNumber=++dn,this.handleChange=this.handleChange.bind(this)}handleChange(e){this.props.onChange(e)}render(){const{label:e,placeholderLabel:t,name:n,type:s,isRequired:r,taId:o,id:i,defaultValue:a,value:l,minLength:d,autoFocus:c,hasError:u,isDisabled:p,isHiddenForScreenReaders:g,useCustomStyle:h,className:m,inputClassName:_,inputRef:f,onBlur:b,onFocus:S,onInput:y,onKeyDown:E,onKeyUp:k}=this.props,w=i||`GlueTextInput-${this.idNumber}`;return(0,At.jsx)("label",{className:h?m:"GlueTextInput",htmlFor:w,"aria-label":e,"aria-hidden":!!g||void 0,children:(0,At.jsx)("input",{className:h?_:on()("GlueTextInput__input",{"GlueTextInput__input--has-error":u}),tabIndex:g?"-1":void 0,type:s,id:w,name:n,"data-ta-id":o,"aria-invalid":u,disabled:p,minLength:d,autoFocus:c,placeholder:t||e,value:a?void 0:l,defaultValue:a,onBlur:b,onFocus:S,onChange:this.handleChange,onInput:a?void 0:y,onKeyDown:E,onKeyUp:k,ref:f,required:r})})}}cn.defaultProps={name:"",type:"text",isRequired:!1,taId:"",defaultValue:void 0,value:"",minLength:0,autoFocus:!1,hasError:!1,isDisabled:!1,isHiddenForScreenReaders:!1,useCustomStyle:!1,onBlur(){},onFocus(){},onChange(){},onInput(){},onKeyDown(){}};class un extends Nt.PureComponent{constructor(e){super(e),this.state={isEditing:!1,passwordVisible:!1},this.handleBlur=this.handleBlur.bind(this),this.handleInput=this.handleInput.bind(this)}handleBlur({target:e,relatedTarget:t}){this.setState({isEditing:!1}),t&&(t.name||"submit"===t.type)&&this.validate(e)}handleInput(){this.setState({isEditing:!0})}handleTogglePasswordVisible=()=>{const e=!this.state.passwordVisible;this.setState({passwordVisible:e}),this.props.onTogglePasswordVisibility&&this.props.onTogglePasswordVisibility(e)};validate(e){const{name:t,onValidate:n,noValidate:s}=this.props;!s&&n&&n(t,Bt(e))}renderPasswordEyeToggler(){const{type:e}=this.props,{passwordVisible:t}=this.state;return"password"!==e?null:(0,At.jsxs)(Nt.Fragment,{children:[(0,At.jsx)("button",{type:"button",onClick:this.handleTogglePasswordVisible,tabIndex:"-1",className:"FormField--passwordEyeIcon "+(t?"passwordVisible":"")}),(0,At.jsx)("span",{tabIndex:"-1",className:"FormField--passwordEyeIcon--cross "+(t?"passwordVisible":"")})]})}render(){const{error:e={},noValidate:t,label:n,name:s,type:r,value:o,isRequired:i,minLength:a,autoFocus:l,isDisabled:d,onChange:c,onKeyUp:u,onFocus:p,rightIcon:g=null}=this.props,{isEditing:h,passwordVisible:m}=this.state,_=g;let f=r;return"password"===r&&m&&(f="text"),(0,At.jsxs)("div",{className:on()("FormField",{"FormField--no-validate":t}),children:[(0,At.jsx)(cn,{label:n,name:s,type:f,taId:`${s}-field`,value:o,isRequired:i,minLength:a,autoFocus:l,hasError:!!e.message&&!h,isDisabled:d,onChange:c,onFocus:p,onKeyUp:u,onBlur:this.handleBlur,onInput:this.handleInput}),_&&(0,At.jsx)(_,{className:"FormField--rightIcon"}),this.renderPasswordEyeToggler(),!t&&!h&&e.message&&(0,At.jsx)(At.Fragment,{children:(0,At.jsx)(ln,{errorMessage:e.message})})]})}}const pn=(0,d.$j)((()=>({})),(()=>({})))(un);class gn extends Nt.PureComponent{constructor(...e){super(...e),this.handleBlur=this.handleBlur.bind(this)}handleBlur(e={}){this.props.onBlur&&this.props.onBlur(e)}render(){const{type:e="text",name:t,label:n,classes:s,hasError:r,...o}=this.props,i=`${t}-field`;return(0,At.jsxs)("span",{className:s,children:[(0,At.jsx)("label",{className:"glue-hidden-visually",htmlFor:i,children:n}),(0,At.jsx)("input",{...o,onBlur:this.handleBlur,type:e,name:t,id:i,"data-ta-id":i,className:on()("form-control Input",{"Input--has-error":r}),"aria-invalid":!!r,placeholder:n,required:!0})]})}}const hn=(new Date).getFullYear()-120,mn=[31,28,31,30,31,30,31,31,30,31,30,31],_n=(e,t,n)=>{const s=new Date(n,t-1,e);return!(e<1||e>((e,t)=>1===e&&t%4==0?29:mn[e])(t,n))&&(!(s.getFullYear()<hn)&&(s.getDate()===e&&s.getMonth()===t-1&&s.getFullYear()===n))},fn=(e,t,n)=>{let s=null;return((e,t,n)=>[e,t,n].reduce(((e,t)=>e&&!!t),!0))(e,t,n)?_n(e,t,n)||(s="invalid"):s="incomplete",s},bn={BIG_ENDIAN:"big",LITTLE_ENDIAN:"little",MIDDLE_ENDIAN:"middle"};class Sn extends Nt.PureComponent{constructor(e){super(e),this.state={isEditing:!1},this.monthStrings=[pt.get("desktop.login.January"),pt.get("desktop.login.February"),pt.get("desktop.login.March"),pt.get("desktop.login.April"),pt.get("desktop.login.May"),pt.get("desktop.login.June"),pt.get("desktop.login.July"),pt.get("desktop.login.August"),pt.get("desktop.login.September"),pt.get("desktop.login.October"),pt.get("desktop.login.November"),pt.get("desktop.login.December")],this.handleInput=this.handleInput.bind(this),this.handleBlur=this.handleBlur.bind(this),this.handleFocus=this.handleFocus.bind(this)}handleInput({target:{name:e,value:t,validity:n={}}}){this.setState({isEditing:!0});const s=parseInt(t,10);n.valueMissing||!isFinite(t)||isNaN(s)?this.props.onChange({...this.props.value,[e]:void 0}):this.props.onChange({...this.props.value,[e]:s})}handleBlur(e){const t=e.relatedTarget?e.relatedTarget.name:null,n=["day","month","year"].includes(t);this.setState({isEditing:n}),n||this.validate()}handleFocus(e){this.setState({isEditing:!0});const t=e.relatedTarget?e.relatedTarget.name:null;!["day","month","year"].includes(t)&&this.props.onFocus&&this.props.onFocus()}validate(){const{day:e,month:t,year:n}=this.props.value,s=fn(e,t,n,this.props.minAge);this.props.onValidate("birthDate",s)}renderYear(e,t,n){return(0,At.jsx)(gn,{type:"number",name:"year",classes:"FormDate__input FormDate__year",label:pt.get("desktop.login.Year"),autoFocus:n,defaultValue:e||"",onInput:this.handleInput,onBlur:this.handleBlur,disabled:this.props.disabled,min:hn,hasError:t.includes("year"),onFocus:this.handleFocus})}renderMonth(e,t,n){return(0,At.jsxs)("select",{name:"month",id:"month-field",className:on()("form-control Input FormDate__input FormDate__month",{"Input--has-error":t.includes("month")}),autoFocus:n,defaultValue:e||"",required:!0,onChange:this.handleInput,onBlur:this.handleBlur,disabled:this.props.disabled,onFocus:this.handleFocus,children:[(0,At.jsx)("option",{value:"",disabled:!0,hidden:!0,children:pt.get("desktop.login.Month")}),this.monthStrings.map(((e,t)=>(0,At.jsx)("option",{value:t+1,children:e},t)))]})}renderDay(e,t,n){return(0,At.jsx)(gn,{type:"number",name:"day",classes:"FormDate__input FormDate__day",label:pt.get("desktop.login.Day"),autoFocus:n,defaultValue:e||"",onInput:this.handleInput,onBlur:this.handleBlur,disabled:this.props.disabled,min:1,max:31,hasError:t.includes("day"),onFocus:this.handleFocus})}render(){const{name:e,label:t,dateEndianness:n,error:s={},autoFocus:r}=this.props,{day:o,month:i,year:a}=this.props.value,{isEditing:l}=this.state,d=["day","month","year"].filter((e=>!(l||!s.message)&&("incomplete"===s.code?!this.props.value[e]:"tooOld"!==s.code||"year"===e)));let c="";return c="big"===bn[n]?(0,At.jsxs)("div",{className:"FormDate__inputs",children:[this.renderYear(a,d,r),this.renderMonth(i,d),this.renderDay(o,d)]}):"little"===bn[n]?(0,At.jsxs)("div",{className:"FormDate__inputs",children:[this.renderDay(o,d,r),this.renderMonth(i,d),this.renderYear(a,d)]}):(0,At.jsxs)("div",{className:"FormDate__inputs",children:[this.renderMonth(i,d,r),this.renderDay(o,d),this.renderYear(a,d)]}),(0,At.jsxs)("div",{className:"FormDate",children:[(0,At.jsx)("label",{className:`FormDate__label ${e}-label`,htmlFor:"month-field",children:t}),c,!l&&s.message&&(0,At.jsx)(At.Fragment,{children:(0,At.jsx)(ln,{errorMessage:s.message})})]})}}Sn.defaultProps={value:{},dateEndianness:"MIDDLE_ENDIAN",minAge:13};const yn=(0,d.$j)((()=>({})),(()=>({})))(Sn);class En extends Nt.PureComponent{constructor(e){super(e),this.state={isEditing:!1},this.handleBlur=this.handleBlur.bind(this),this.handleFocus=this.handleFocus.bind(this)}handleBlur(e){this.state={isEditing:!1};(e.relatedTarget?e.relatedTarget.name:null)!==this.props.name&&this.validate(e.target)}handleFocus(e){this.state={isEditing:!0},this.props.onOptionFocus&&e&&e.target&&this.props.onOptionFocus(e.target.value)}validate(e){const{name:t,onValidate:n}=this.props;n&&n(t,Bt(e))}render(){const{name:e,label:t,options:n,value:s,showTitle:r,error:o={},onValidate:i,onOptionFocus:a,...l}=this.props,{isEditing:d}=this.state,c=`${e}-field`,u=on()("FormRadioSelect",{"FormRadioSelect--is-disabled":this.props.disabled});return(0,At.jsxs)("div",{className:u,children:[(0,At.jsx)("label",{className:r?"":"glue-hidden-visually",htmlFor:c,children:t}),n.map((t=>{const n=`${t.value}-radio`;return(0,At.jsxs)("span",{className:s===t.value?"checked":"",children:[(0,At.jsx)("input",{...l,name:e,type:"radio",id:n,className:"glue-hidden-visually",value:t.value,checked:s===t.value,onBlur:this.handleBlur,onFocus:this.handleFocus,required:!0,disabled:this.props.disabled}),(0,At.jsx)("label",{className:on()("FormRadioSelect__label",{"FormRadioSelect__label--has-error":!!o.message}),htmlFor:n,children:t.label})]},t.value)})),!d&&o.message&&(0,At.jsx)(At.Fragment,{children:(0,At.jsx)(ln,{errorMessage:o.message})})]})}}const kn=(0,d.$j)((()=>({})),(()=>({})))(En);class wn extends Nt.PureComponent{constructor(...e){super(...e),this.handleChange=this.handleChange.bind(this)}handleChange(e){this.props.isDisabled||this.props.onChange(e.target.checked)}render(){const e=`${this.props.name}-field`,t=on()("GlueCheckbox",{"GlueCheckbox--is-disabled":this.props.isDisabled});return(0,At.jsxs)("div",{className:t,children:[(0,At.jsx)("input",{className:"GlueCheckbox__input",id:e,name:this.props.name,checked:this.props.isChecked,type:"checkbox",onChange:this.handleChange,disabled:this.props.isDisabled}),(0,At.jsx)("label",{className:"GlueCheckbox__label",htmlFor:e,dangerouslySetInnerHTML:{__html:this.props.label}})]})}}wn.defaultProps={label:"",name:"",isChecked:!1,isDisabled:!1,onChange(){}};class Cn extends Nt.Component{constructor(e){super(e),this.handleClick=this.handleClick.bind(this)}handleClick(e){if(e.target.getAttribute("data-action")){const t=e.target.getAttribute("data-action");"showSettings"===t?this.props.openSettingsPage():"showSignup"===t&&this.props.openSignupPage()}}render(){const e=this.props.errorData,t=e?Gt(e.errorCategory,e.errorCode,e.errorReference):null;return t?(0,At.jsxs)("div",{className:"alert alert-danger ErrorMessage alert-icon",id:"login-message","data-ta-id":"login-message","data-testid":"login-message",role:"alert","aria-live":"assertive",onClick:this.handleClick,children:[(0,At.jsx)(Mt.l,{iconSize:24}),(0,At.jsx)("span",{dangerouslySetInnerHTML:{__html:t}})]}):null}}const vn=(0,d.$j)((e=>{let{mode:t}=e.app;return"welcome"===t&&(t="signup"),{errorData:e[t]&&e[t].errorData?e[t].errorData:null}}),(e=>({openSettingsPage:()=>e(It.enterSettingsMode()),openSignupPage:()=>e(It.openSignupPage())})))(Cn);class xn extends Nt.PureComponent{static getNextId(){const e=(xn.instanceCount||0)+1;return xn.instanceCount=e,e}constructor(e){super(e),this.state={tosAgreed:!1,privacyAgreed:!1},this.handleTosChange=this.handleTosChange.bind(this),this.handlePrivacyChange=this.handlePrivacyChange.bind(this),this.handleTosAndPrivacyChange=this.handleTosAndPrivacyChange.bind(this),this.handleEulaChange=this.handleEulaChange.bind(this),this.eulaId=xn.getNextId()}handleTosChange(e){this.setState({tosAgreed:e},(()=>{this.handleEulaChange()}))}handlePrivacyChange(e){this.setState({privacyAgreed:e},(()=>{this.handleEulaChange()}))}handleTosAndPrivacyChange(e){this.setState({tosAgreed:e,privacyAgreed:e},(()=>{this.handleEulaChange()}))}handleEulaChange(){this.props.onChange(this.state.tosAgreed&&this.state.privacyAgreed)}render(){let e=null;const t=`<a href="https://www.spotify.com/int/legal/end-user-agreement/" target="_new">${pt.get("desktop.login.TermsAndConditions")}</a>`,n=`<a href="https://www.spotify.com/int/legal/privacy-policy/" target="_new">${pt.get("desktop.login.PrivacyPolicy")}</a>`,s=pt.get("desktop.login.SignupButton");return e=this.props.restrictions.pretick_eula?(0,At.jsxs)("div",{children:[!this.props.hideTermsAndConditions&&(0,At.jsx)("p",{className:"SignupForm__terms-and-conditions",dangerouslySetInnerHTML:{__html:pt.get("desktop.login.SignupAgree",s,t)}}),!this.props.hidePrivacyPolicy&&(0,At.jsx)("p",{className:"SignupForm__privacy-policy",dangerouslySetInnerHTML:{__html:pt.get("desktop.login.PrivacyPolicyAgree",n)}})]}):this.props.restrictions.can_accept_licenses_in_one_step?(0,At.jsxs)("div",{className:"SignupForm__checkbox-container",children:[(0,At.jsx)(wn,{"data-ta-id":"agree-eula",name:`agree-eula-${this.eulaId}`,label:this.props.restrictions.specific_licenses?pt.get("desktop.login.SignupAgreeCheckboxSpecificLicenses",t,n):pt.get("desktop.login.SignupAgreeCheckbox",t,n),onChange:this.handleTosAndPrivacyChange,isChecked:this.state.tosAgreed&&this.state.privacyAgreed,isDisabled:this.props.disabled}),this.props.restrictions.specific_licenses&&(0,At.jsx)("p",{className:"SignupForm__privacy-policy",dangerouslySetInnerHTML:{__html:pt.get("desktop.login.PrivacyPolicyAgree",n)}})]}):(0,At.jsxs)("div",{children:[(0,At.jsx)("div",{className:"SignupForm__checkbox-container",children:(0,At.jsx)(wn,{"data-ta-id":"agree-tos",name:`agree-tos-${this.eulaId}`,label:pt.get("desktop.login.TermsOfServiceAgreeCheckbox",t),onChange:this.handleTosChange,isChecked:this.state.tosAgreed,isDisabled:this.props.disabled})}),(0,At.jsx)("div",{className:"SignupForm__checkbox-container",children:(0,At.jsx)(wn,{"data-ta-id":"agree-privacy",name:`agree-privacy-${this.eulaId}`,label:pt.get("desktop.login.PrivacyPolicyAgreeCheckbox",n),onChange:this.handlePrivacyChange,isChecked:this.state.privacyAgreed,isDisabled:this.props.disabled})})]}),(0,At.jsxs)("div",{className:"EulaAgreement",children:[e,this.props.error&&(0,At.jsx)(At.Fragment,{children:(0,At.jsx)(ln,{errorMessage:this.props.error.message})})]})}}const Tn=(0,d.$j)((()=>({})),(()=>({})))(xn);class In extends Nt.PureComponent{handleClick=e=>{const{method:t}=this.props;e&&(e.preventDefault(),e.stopPropagation()),this.props.onClick(t)};render(){const{type:e,label:t,isDisabled:n,method:s}=this.props,r=s.substr(0,1).toUpperCase()+s.substr(1),o=on()("button","SocialButton",`${r}Button`,{[`${r}Button--login`]:"login"===e,[`${r}Button--signup`]:"signup"===e});return(0,At.jsx)("button",{type:"button",className:o,onClick:this.handleClick,"data-ta-id":`${s}-${e}-button`,disabled:n,children:t})}}class Nn extends Nt.PureComponent{static defaultProps={isDisabled:!1,hideEula:!1};constructor(e){super(e),this.state={eulaAgreed:this.props.restrictions.pretick_eula,error:{}}}handleAgreeEulaChange=e=>{const t=e?"checked":"unchecked";this.props.onInteraction("signup","click",`eula-change-${t}`),this.setState({eulaAgreed:e,error:e?{}:this.state.error})};handleOnClick=(...e)=>{(()=>this.state.eulaAgreed||this.props.restrictions.pretick_eula||this.props.hideEula)()?this.props.onClick(...e):this.setState({error:{message:pt.get("desktop.login.agreeEula.notAccepted")}})};render(){return(0,At.jsxs)("div",{className:"SignupFacebook",children:[(0,At.jsx)(In,{method:"facebook",isDisabled:this.props.isDisabled,onClick:this.handleOnClick,type:"signup",label:pt.get("desktop.login.SignupButtonFacebookNirvana")}),this.props.restrictions.pretick_eula||this.props.hideEula?null:(0,At.jsx)(Tn,{restrictions:this.props.restrictions,error:this.state.error,disabled:this.props.isDisabled,onChange:this.handleAgreeEulaChange})]})}}const An=(0,d.$j)((e=>({isDisabled:!!e.signup.isAttempting,restrictions:e.signup.restrictions})),(e=>({onInteraction:(t,n,s,r,o)=>e(It.interaction(t,n,s,r,o)),onClick:t=>{const n=Ot();e(It.signupWithAccounts(t,n)),e(It.interaction("signup","click",`create-account-${t}`,null,n))}})),((e,t)=>({...e,...t,onClick:e=>{t.onClick(e)}})))(Nn),Pn=({title:e})=>(0,At.jsx)("p",{className:"FormTitleSeparator","aria-hidden":"true",children:e});Pn.defaultProps={title:""};const Dn=Pn;class Fn extends Nt.PureComponent{static defaultProps={errors:{},data:{},step:0};constructor(e){super(e),this.state={isEditing:!0}}handleEmailValidate=(e,t)=>{this.props.onValidate(e,t),t||this.props.validateEmail()};handleEmailFocus=()=>{this.props.onInteraction("signup","click","input-email")};handlePasswordValidate=(e,t)=>{this.props.onValidate(e,t),t||this.props.validatePassword()};handlePasswordFocus=()=>{this.props.onInteraction("signup","click","input-password")};handleNameFocus=()=>{this.props.onInteraction("signup","click","input-name")};handleGenderOptionFocus=e=>{this.props.onInteraction("signup","click",`input-gender-${e}`)};handleInputChange=({target:{name:e,value:t}})=>{this.props.updateData({[e]:t}),this.setState({isEditing:!0})};handleBirthDateChange=e=>{this.props.updateData({birthDate:e})};handleSendEmailChange=e=>{this.props.updateData({sendEmail:e})};handleShareDataChange=e=>{this.props.updateData({shareData:e})};handleAgreeEulaChange=e=>{this.props.updateData({agreeEula:e})};handleSubmit=e=>{e&&e.preventDefault();const{step:t}=this.props,n=Ot();this.props.onInteraction("signup","click",0===t?"continue":"create-account",null,n),this.setState({isEditing:!1});let s=!0;const r={0:["email","password","name"],1:["birthDate","gender","agreeEula"]};!!this.props.errors&&Object.keys(this.props.errors).filter((e=>-1!==r[t].indexOf(e))).some((e=>this.props.errors[e]&&this.props.errors[e].message))&&(s=!1);const o=e=>t=>{this.props.data[t]||(this.props.onValidate(t,{code:e}),s=!1)};switch(t){case 0:["email","password","name"].forEach(o("valueMissing"));break;case 1:{const{day:e,month:t,year:r}=this.props.data.birthDate;r||this.props.onInteraction("signup","view","show-error-empty-year",null,n),t||this.props.onInteraction("signup","view","show-error-empty-month",null,n),e||this.props.onInteraction("signup","view","show-error-empty-date",null,n);const i=fn(e,t,r,this.props.restrictions.minimum_age);i&&(this.props.onValidate("birthDate",{code:i}),s=!1),o("valueMissing")("gender"),o("notAccepted")("agreeEula")}}if(s)switch(t){case 0:this.setStep(t+1);break;case 1:this.props.signup(n)}};handleBack=()=>{const{step:e}=this.props;this.props.onInteraction("signup","click",`back-step-${e+1}`),this.props.clearAllErrors(),e<=0?this.props.enterWelcomeMode():this.setStep(e-1)};handleLogin=()=>{const e=Ot();this.props.onInteraction("signup","click","open-page-login",null,e),this.props.enterLoginMode(e)};setStep=e=>{switch(e){case 0:this.props.enterSignupModeStep0();break;case 1:this.props.enterSignupModeStep1()}};renderErrorMsg(){const e=Object.keys(this.props.errors).filter((e=>this.props.errors[e]&&this.props.errors[e].message));return(0,At.jsx)("div",{className:"glue-hidden-visually",role:"alert","aria-live":this.state.isEditing?"off":"assertive",children:e.length>0?(0,At.jsxs)("div",{children:[(0,At.jsx)("p",{children:pt.get("desktop.login.email.errorMessageA11y",e.length)}),(0,At.jsx)("ul",{children:e.map((e=>(0,At.jsx)("li",{children:this.props.errors[e].message},e)))})]}):null})}renderStep0(){const{data:e,errors:t,isDisabled:n,onValidate:s}=this.props;return(0,At.jsxs)("div",{children:[(0,At.jsx)(pn,{name:"email",type:"email",label:pt.get("desktop.login.SignupEmail"),value:e.email,onChange:this.handleInputChange,isDisabled:n,error:t.email,onValidate:this.handleEmailValidate,onFocus:this.handleEmailFocus,isRequired:!0,autoFocus:!0,rightIcon:tn.B}),(0,At.jsx)(pn,{name:"password",type:"password",label:pt.get("desktop.login.CreateAPassword"),value:e.password,onChange:this.handleInputChange,minLength:8,isRequired:!0,isDisabled:n,error:t.password,onValidate:this.handlePasswordValidate,onFocus:this.handlePasswordFocus,onTogglePasswordVisibility:e=>{this.props.onInteraction("signup","click",e?"toggle-password-visibility-show":"toggle-password-visibility-hide")}}),(0,At.jsx)(pn,{name:"name",label:pt.get("desktop.login.SignupName"),value:e.name,onChange:this.handleInputChange,isRequired:!0,isDisabled:n,error:t.name,onValidate:s,rightIcon:nn.W,onFocus:this.handleNameFocus})]})}renderStep1(){const{data:e,errors:t,restrictions:n,isDisabled:s,onValidate:r}=this.props;let o=null;n.requires_marketing_opt_in_text?o=(0,At.jsx)("div",{className:"SignupForm__send-email-implicit",children:pt.get("desktop.login.SendEmailImplicitLabel")}):n.requires_marketing_opt_in&&(o=(0,At.jsx)("div",{className:"SignupForm__checkbox-container",children:(0,At.jsx)(wn,{name:"send-email",label:pt.get("desktop.login.SendEmailLabel"),onChange:this.handleSendEmailChange,isChecked:e.sendEmail,isDisabled:s})}));const i=[{label:pt.get("desktop.login.Female"),value:"female"},{label:pt.get("desktop.login.Male"),value:"male"}];return n.use_all_genders&&i.push({label:pt.get("desktop.login.NonBinary"),value:"neutral"}),(0,At.jsxs)("div",{children:[(0,At.jsx)(yn,{name:"birth-date",label:pt.get("desktop.login.WhatsYourSignupBirthDate"),value:e.birthDate,onChange:this.handleBirthDateChange,disabled:s,error:t.birthDate,onValidate:r,dateEndianness:n.date_endianness,minAge:n.minimum_age,autoFocus:!0,onFocus:()=>{this.props.onInteraction("signup","click","input-birth-date")}}),(0,At.jsx)(kn,{showTitle:!0,name:"gender",label:pt.get("desktop.login.WhatsYourSignupGender"),options:i,value:e.gender,onChange:this.handleInputChange,disabled:s,error:t.gender,onValidate:r,onOptionFocus:this.handleGenderOptionFocus}),o,(0,At.jsx)(Tn,{restrictions:n,error:t.agreeEula,disabled:s,onChange:this.handleAgreeEulaChange})]})}render(){const{isDisabled:e,step:t}=this.props;return(0,At.jsxs)("form",{onSubmit:this.handleSubmit,className:"SignupForm",children:[this.renderErrorMsg(),(0,At.jsx)(vn,{}),0===t?this.renderStep0():"",1===t?this.renderStep1():"",(0,At.jsx)(Lt.D,{type:"submit",disabled:e,id:"signup-button",onClick:this.handleSubmit,"data-ta-id":"signup-submit",fullWidth:!0,children:0===t?pt.get("desktop.login.Continue"):pt.get("desktop.login.SignupButton")}),0===t&&(0,At.jsxs)(Nt.Fragment,{children:[(0,At.jsx)(Dn,{title:pt.get("desktop.login.SignupOr")}),(0,At.jsx)(An,{})]}),(0,At.jsx)(sn.o,{onClick:this.handleBack,children:pt.get("desktop.login.Back")}),0===t&&(0,At.jsx)("h3",{className:"FooterFormText",children:(0,At.jsx)("a",{className:"FooterFormText__NoUnderline",href:"#",id:"login-link",onClick:this.handleLogin,dangerouslySetInnerHTML:{__html:pt.get("desktop.login.AlreadyOnSpotifyLogin")}})})]})}}const On=(0,d.$j)((e=>({isDisabled:!!e.signup.isAttempting,restrictions:e.signup.restrictions,email:e.signup.email,errors:e.signup.errors,data:e.signup.formData})),(e=>({signup:t=>e(It.signup(t)),enterLoginMode:()=>e(It.enterLoginMode()),enterSignupModeStep0:()=>e(It.enterSignupModeStep0()),enterSignupModeStep1:()=>e(It.enterSignupModeStep1()),updateData:t=>e(It.updateSignupData(t)),validateEmail:()=>e(It.validateField("email")),validatePassword:()=>e(It.validateField("password")),enterWelcomeMode:()=>e(It.enterWelcomeMode()),clearAllErrors:()=>e(It.clearAllErrors()),onValidate:(t,n)=>{if(n){const s=n.code||n,r={birthDate:{incomplete:pt.get("desktop.login.birthDate.incomplete"),invalid:pt.get("desktop.login.birthDate.invalid")},password:{valueMissing:pt.get("desktop.login.password.valueMissing"),tooShort:pt.get("desktop.login.password.tooShort")},email:{valueMissing:pt.get("desktop.login.email.valueMissing"),typeMismatch:pt.get("desktop.login.email.typeMismatch")},name:{valueMissing:pt.get("desktop.login.name.valueMissing")},gender:{valueMissing:pt.get("desktop.login.gender.valueMissing")},agreeEula:{notAccepted:pt.get("desktop.login.agreeEula.notAccepted")}};e(It.validateFieldFailure(t,{code:s,message:r[t]&&r[t][s]||""}))}else e(It.validateFieldSuccess(t))},onInteraction:(t,n,s,r,o)=>e(It.interaction(t,n,s,r,o))})))(Fn);class Mn extends Nt.PureComponent{render(){const{step:e,restrictions:t}=this.props;if(!t)return(0,At.jsx)(Pt,{delay:2e3});const n=0===e?pt.get("desktop.login.SignupHeroText"):pt.get("desktop.login.SignupAlmostDone");return(0,At.jsxs)("main",{className:"Signup","data-testid":"signup","aria-labelledby":"signup-form-title",id:"signup","data-ta-id":"signup-form",children:[(0,At.jsx)("h1",{className:"HeroText",id:"signup-form-title",children:n}),(0,At.jsx)(On,{step:e})]})}}const Ln=(0,d.$j)((e=>({isDisabled:!!e.signup.isAttempting,restrictions:e.signup.restrictions})))(Mn);class jn extends Nt.PureComponent{constructor(...e){super(...e),this.handleChange=this.handleChange.bind(this)}handleChange(){this.props.isDisabled||this.props.onChange(!this.props.isActive)}render(){const{isActive:e,isDisabled:t,labelId:n,taId:s}=this.props;return(0,At.jsxs)("div",{className:on()("GlueToggle",{"GlueToggle--is-active":e,"GlueToggle--is-disabled":t}),children:[(0,At.jsx)("input",{type:"checkbox",name:n,id:n,className:"glue-hidden-visually",onChange:this.handleChange,checked:e,disabled:t,"data-ta-id":s}),(0,At.jsx)("div",{className:"GlueToggle__toggle",onClick:this.handleChange,"aria-hidden":"true",children:(0,At.jsx)("div",{className:"GlueToggle__toggle-inner"})})]})}}jn.defaultProps={isActive:!1,isDisabled:!1,onChange:()=>{}};class Rn extends Nt.PureComponent{render(){const{name:e,label:t,checked:n,disabled:s,onChange:r}=this.props,o=`${e}-field`;return(0,At.jsxs)("div",{className:"FormToggle",children:[(0,At.jsx)("label",{htmlFor:o,"data-ta-id":"remember-me-label",children:t}),(0,At.jsx)(jn,{labelId:o,isActive:n,onChange:r,taId:"remember-me-slider",isDisabled:s})]})}}class Un extends Nt.PureComponent{constructor(e){super(e),this.state={username:this.props.username,password:"",rememberMe:!0},["handleSubmit","handleUsernameChange","handleUsernameFocus","handlePasswordChange","handlePasswordFocus","handleRememberMeChange"].forEach((e=>{this[e]=this[e].bind(this)}))}handleUsernameChange({target:e}){this.setState({username:e.value})}handleUsernameFocus(){this.props.onInteraction("login","click","input-email")}handlePasswordChange({target:e}){this.setState({password:e.value})}handlePasswordFocus(){this.props.onInteraction("login","click","input-password")}handleRememberMeChange(){this.setState({rememberMe:!this.state.rememberMe})}handleSubmit(e){e&&e.preventDefault();const t=this.state.username.trim(),{password:n,rememberMe:s}=this.state,r=Ot();this.props.onInteraction("login","click","login-email",null,r),t&&n?this.props.login({username:t,password:n,rememberMe:s},!1,r):t?n||this.props.onInteraction("login","view","show-error-empty-password",null,r):this.props.onInteraction("login","view","show-error-empty-email",null,r)}handleForgotPasswordLinkClick=()=>{this.props.onInteraction("login","click","reset-password")};render(){const{isDisabled:e}=this.props;return(0,At.jsxs)("form",{onSubmit:this.handleSubmit,children:[(0,At.jsx)("h3",{className:"glue-hidden-visually",children:pt.get("desktop.login.LoginWithEmailTitle")}),(0,At.jsx)(vn,{}),(0,At.jsx)(pn,{name:"username",label:pt.get("desktop.login.LoginUsernameOrEmail"),value:this.state.username||"",onChange:this.handleUsernameChange,onFocus:this.handleUsernameFocus,isDisabled:e,autoFocus:!0,noValidate:!0,rightIcon:tn.B}),(0,At.jsx)(pn,{name:"password",type:"password",label:pt.get("desktop.login.LoginPassword"),value:this.state.password,onChange:this.handlePasswordChange,onFocus:this.handlePasswordFocus,isDisabled:e,noValidate:!0}),(0,At.jsx)("a",{className:"LoginForm__reset-password",href:"https://www.spotify.com/redirect/password-reset",target:"_new",onClick:this.handleForgotPasswordLinkClick,children:pt.get("desktop.login.forgotPassLink")}),(0,At.jsx)(Rn,{name:"remember-me",label:pt.get("desktop.login.RememberMeLabel"),checked:this.state.rememberMe,onChange:this.handleRememberMeChange,disabled:e}),(0,At.jsx)("button",{type:"submit",className:"button button-white LoginForm__login-button",disabled:e,id:"login-button","data-ta-id":"login-button",children:pt.get("desktop.login.LoginButton")})]})}}const Gn=(0,d.$j)((e=>({isDisabled:!!e.login.loginInProgress,username:e.login.username})),(e=>({login:(t,n,s)=>e(It.login(t,n,s)),onInteraction:(t,n,s,r,o)=>e(It.interaction(t,n,s,r,o))})))(Un);class Bn extends Nt.PureComponent{componentWillUnmount(){this.props.clearErrors()}handleSignup(){const e=Ot();this.props.enterSignupMode(e),this.props.onInteraction("login","click","open-page-signup",null,e)}getSignupLink(){return(0,At.jsx)("a",{className:"FooterFormText__NoUnderline",href:"#",id:"signup-link",onClick:()=>this.handleSignup(),"data-ta-id":"signup-link",dangerouslySetInnerHTML:{__html:pt.get("desktop.login.DontHaveAnAccountSignup")}})}render(){const{isDisabled:e}=this.props;return(0,At.jsxs)("main",{className:"Login","data-testid":"login","aria-labelledby":"login-form-title",id:"login","data-ta-id":"login-form",children:[(0,At.jsx)("h1",{className:"HeroText",id:"login-form-title",children:pt.get("desktop.login.LoginHeroText")}),(0,At.jsx)(Gn,{}),(0,At.jsx)(Dn,{title:pt.get("desktop.login.SignupOr")}),(0,At.jsx)(In,{method:"facebook",isDisabled:e,onClick:this.props.onSocialButtonClick,type:"login",label:pt.get("desktop.login.ContinueWithFacebook")}),(0,At.jsx)(In,{method:"google",isDisabled:e,onClick:this.props.onSocialButtonClick,type:"login",label:pt.get("desktop.login.ContinueWithGoogle")}),(0,At.jsx)(In,{method:"apple",isDisabled:e,onClick:this.props.onSocialButtonClick,type:"login",label:pt.get("desktop.login.ContinueWithApple")}),(0,At.jsx)("h3",{className:"FooterFormText",children:this.getSignupLink()})]})}}const Wn=(0,d.$j)((e=>({isDisabled:!!e.login.loginInProgress})),(e=>({enterSignupMode:t=>e(It.enterSignupMode(t)),onInteraction:(t,n,s,r,o)=>e(It.interaction(t,n,s,r,o)),onSocialButtonClick:t=>{const n=Ot();e(It.loginWithAccounts(t,n)),e(It.interaction("login","click",`login-${t}`,null,n))},clearErrors:()=>e(It.loginClearErrors())})),((e,t)=>({...e,...t,onSocialButtonClick:e=>{t.onSocialButtonClick(e)}})))(Bn);class Vn extends Nt.PureComponent{render(){const{operationUsed:e}=this.props,t="signup"===e?pt.get("desktop-auth.login.redirecting-to-browser-signup"):pt.get("desktop-auth.login.redirecting-to-browser-login");return(0,At.jsx)("main",{children:(0,At.jsx)("h1",{className:"HeroText __redirect",children:t})})}}const $n=(0,d.$j)((e=>({operationUsed:e.experimentWebAuthReducer.operationUsed})))(Vn);var Hn=n(2842),Kn=n.n(Hn);const Yn="zrvvPyoxE6wQNqnu0yWA",qn="jmu6DFPvhxRl0wSfmv2O",zn=({value:e,id:t,children:n,disabled:s,onSelect:r,className:o,dir:i})=>(0,At.jsx)("span",{className:o,children:(0,At.jsx)("select",{className:on()(Yn,{[qn]:"Safari"===Kn().parse(window.navigator.userAgent).browser.name}),value:e?.toString(),id:t,disabled:s,onBlur:()=>{},onChange:e=>{r(e.target.value)},dir:i,children:n})});(0,n(2666).Z)((e=>({lastFilterState:"",lastFilteredUri:"",setLastState:(t,n)=>{e({lastFilterState:t,lastFilteredUri:n})}})));const Jn=(0,Nt.createContext)({setFilter:()=>{throw new Error("setFilter must be used within a FilterProvider")},filter:""});n(5684);let Xn;!function(e){e.UPDATE="update"}(Xn||(Xn={}));const Zn=new Intl.Collator(void 0,{sensitivity:"base",usage:"search"}),Qn=/\p{White_Space}/u,es=/\p{P}/u,ts=/\p{sc=Han}/u;function ns(e){return null!==e&&Qn.test(e)}function ss(e){return null!==e&&(e<="/"||e>=":"&&e<="@"||"\\"===e||ns(e))}function rs(e){return null!==e&&es.test(e)}function os(e){return null!==e&&ts.test(e)}class is{constructor(e,t,n){if(t<0||n<0||t+n>e.length)throw new RangeError;this.data=e,this.offset=t,this.length=n,this.position=0}static from(e){const t=Array.from(e.normalize("NFC"));return new is(t,0,t.length)}toString(){return this.data.slice(this.offset,this.offset+this.length).join("")}slice(e=0,t=this.length){if(e<0||t>this.length)throw new RangeError;const n=this.offset+e,s=t-e;return new is(this.data,n,s)}nextCodePoint(){return this.position===this.length?null:this.data[this.offset+this.position++]}}function as(e){let t;do{t=e.nextCodePoint()}while(null!==t&&ns(t)||rs(t));return t}function ls(e,t){let n=as(e),s=as(t);if(null===s)return{offset:0,length:0};const r=e.offset+e.position-1;let o=e.offset+e.position;for(;;){if(null===n&&null===s)return{offset:r,length:o-r};if(null===s)return{offset:r,length:o-r};if(null===n)return null;if(0!==Zn.compare(n,s))return null;o=e.offset+e.position,n=as(e),s=as(t)}}function ds(e,t){let n,s,r;do{s=e.position,n=e.nextCodePoint()}while(null!==n&&ns(n));if(t?.segmentQuotedStrings&&function(e){return null!==e&&('"'===e||"'"===e)}(n)){const t=n;s=e.position;do{r=e.position,n=e.nextCodePoint()}while(null!==n&&n!==t);return null===n&&s===r?null:e.slice(s,r)}do{if(r=e.position,t?.segmentCJKUnifieIdeographs&&os(n))break;n=e.nextCodePoint()}while(null!==n&&!ss(n));return null===n&&s===r?null:e.slice(s,r)}function cs(e){return ds(e,{segmentQuotedStrings:!0,segmentCJKUnifieIdeographs:!1})}function us(e){return ds(e,{segmentQuotedStrings:!1,segmentCJKUnifieIdeographs:!0})}function ps(e,t){const n=[];for(let s=us(e);null!==s;s=us(e)){let r=ls(s,t.slice());null===r?(r=ls(e.slice(s.offset),t.slice()),null===r||n.push(r)):n.push(r)}return n}function gs(e,t){return e.offset===t.offset&&e.length===t.length}const hs=(e,t)=>"string"==typeof e&&"string"==typeof t?!(e.length>0)||null!==function(e,...t){const n=is.from(e),s=[];for(let e=cs(n);null!==e;e=cs(n)){const n=[];for(let s=0;s<t.length;++s){const r=t[s],o=ps(is.from(r),e);for(const e of o)n.push({text:r,range:e})}if(0===n.length)return null;s.push(...n.filter(((e,t,n)=>e.range.length>0&&n.findIndex((t=>gs(e.range,t.range)))===t)))}return s.length>0?s:null}(e,t):"boolean"!=typeof e||e,ms=(0,Nt.createContext)(void 0),_s=({children:e})=>{const[t,n]=(0,Nt.useState)(!1),[s,r]=(0,Nt.useState)(new Set),o=(0,Nt.useCallback)(((e,t)=>{r((n=>{if(n.has(e)===t)return n;const s=new Set(n);return t?s.add(e):s.delete(e),s}))}),[]),i=s.size>0;return(0,At.jsx)(ms.Provider,{value:{sectionMatch:t,setSectionMatch:n,sectionContainsMatch:i,setSectionFilterMatchQueryValue:o},children:e})},fs="c6TyNYOUJRIsjYZJZofy";function bs({children:e,filterMatchQuery:t}){const{filter:n}=(0,Nt.useContext)(Jn),{setSectionMatch:s,sectionContainsMatch:r}=(()=>{const e=(0,Nt.useContext)(ms);if(void 0===e)throw new Error("useSectionMatchState() must be used within a SectionFilterMatchContextProvider");return e})(),o=hs(n,t);return(0,Nt.useEffect)((()=>{s(o)}),[o,s]),o||r?(0,At.jsx)("div",{className:fs,children:e}):null}function Ss(e){return(0,At.jsx)(_s,{children:(0,At.jsx)(bs,{...e})})}var ys=n(7631),Es=n.n(ys);const ks="M0E2Al6URHV3iyoDbvi_";function ws({searchWords:e,textToHighlight:t,...n}){return 0===e.length||e.every((e=>!e))?(0,At.jsx)(At.Fragment,{children:t}):(0,At.jsx)(Es(),{highlightClassName:ks,searchWords:e,textToHighlight:t,autoEscape:!0,...n})}function Cs({children:e}){const{filter:t}=(0,Nt.useContext)(Jn);return(0,At.jsx)(Ut.D,{as:"h2",variant:"cello",semanticColor:"textBase",children:(0,At.jsx)(ws,{searchWords:[t],textToHighlight:e})})}var vs=n(9113);const xs="gvcgOXnAiNKEe_z92_lw";function Ts({onClick:e}){return(0,At.jsx)(vs.P,{className:xs,onClick:e,children:pt.get("settings.restartApp")})}var Is=n(2292);const Ns="mpdBa62OP4Fr5wvCsa89",As="acVhMt5pELcXQyLaaPuV",Ps="AavUTirpKSAHapguSAy0",Ds="SkbGMKYv49KtJNB5XxdX",Fs="qfjicQPaTTPrLWJWRxMQ",Os=({id:e,type:t,placeHolder:n,inputRef:s,handleOnChange:r})=>(0,At.jsx)("input",{type:t||"text",id:e,"data-testid":e,className:Ds,placeholder:n,ref:s,onChange:r}),Ms=({children:e,label:t})=>(0,At.jsx)(Is.c,{label:t,className:Fs,children:e}),Ls=(e,t,n)=>{let s=`${e}:${t}`;switch(n){case gt:s+="@http";break;case ht:s+="@socks4";break;case mt:s+="@socks5"}return s},js=({addr:e,mode:t,pass:n,user:s,setValue:r,restartContainer:o,fullWidth:i})=>{const a=(0,Nt.useRef)(null),l=(0,Nt.useRef)(null),d=(0,Nt.useRef)(null),c=(0,Nt.useRef)(null),[u,p]=(0,Nt.useState)(""),[g,h]=(0,Nt.useState)(""),[m,_]=(0,Nt.useState)(!1);(0,Nt.useEffect)((()=>{const[t,n]=e?.split(/[:@]+/)||["",""];p(t),h(n),a.current&&(a.current.value=t),l.current&&(l.current.value=n)}),[e]),(0,Nt.useEffect)((()=>{c.current&&n&&(c.current.value=n.toString())}),[n]),(0,Nt.useEffect)((()=>{d.current&&s&&(d.current.value=s.toString())}),[s]);const f=(0,Nt.useCallback)((({target:e})=>{const n=Ls(e.value,g,t||0);p(e.value),r("network.proxy.addr",n),_(!0)}),[t,g,r]),b=(0,Nt.useCallback)((({target:e})=>{const n=Ls(u,e.value,t||0);h(e.value),r("network.proxy.addr",n),_(!0)}),[t,u,r]),S=(0,Nt.useCallback)((({target:e})=>{r("network.proxy.user",e.value),_(!0)}),[r]),y=(0,Nt.useCallback)((({target:e})=>{r("network.proxy.pass",e.value),_(!0)}),[r]),E=0!==t&&1!==t,k=t!==ht;return(0,At.jsxs)(Ss,{filterMatchQuery:pt.get("desktop.settings.proxy.title"),children:[(0,At.jsx)(Cs,{children:pt.get("desktop.settings.proxy.title")}),(0,At.jsxs)("div",{className:on()(As,i?Ps:null),children:[(0,At.jsx)(Ms,{label:pt.get("desktop.settings.proxy.type"),children:(0,At.jsx)(zn,{id:"network.proxy.mode",value:t,onSelect:e=>{const t=parseInt(e,10);r("network.proxy.mode",t),_(!0)},children:ft.map((({enumKey:e,enumValue:t})=>(0,At.jsx)("option",{value:t,"data-testid":e,children:_t[e]?_t[e].label():""},e)))})}),E?(0,At.jsxs)(At.Fragment,{children:[(0,At.jsxs)("div",{className:Ns,children:[(0,At.jsx)(Ms,{label:pt.get("desktop.settings.proxy.host"),children:(0,At.jsx)(Os,{id:"network.proxy.host",handleOnChange:f,placeHolder:pt.get("desktop.settings.proxy.host"),inputRef:a})}),(0,At.jsx)(Ms,{label:pt.get("desktop.settings.proxy.port"),children:(0,At.jsx)(Os,{id:"network.proxy.port",type:"number",handleOnChange:b,placeHolder:pt.get("desktop.settings.proxy.port"),inputRef:l})})]}),(0,At.jsxs)("div",{className:k?Ns:void 0,children:[(0,At.jsx)(Ms,{label:pt.get("desktop.settings.proxy.user"),children:(0,At.jsx)(Os,{id:"network.proxy.user",handleOnChange:S,placeHolder:pt.get("desktop.settings.proxy.user"),inputRef:d})}),k?(0,At.jsx)(Ms,{label:pt.get("desktop.settings.proxy.pass"),children:(0,At.jsx)(Os,{id:"network.proxy.pass",handleOnChange:y,placeHolder:pt.get("desktop.settings.proxy.pass"),type:"password",inputRef:c})}):null]})]}):null,m&&(0,At.jsx)("div",{children:(0,At.jsx)(Ts,{onClick:o})})]})]})},Rs=["network.proxy.mode","network.proxy.addr","network.proxy.user","network.proxy.pass"];const Us=(0,d.$j)((e=>({settings:{proxy:e.settings.proxy}})),(e=>({fetchProxySettings(){e(It.fetchProxySettings())},updateProxySettings(t){e(It.updateProxySettings(t))},restartClient(){e(It.restartClient())}})))((({settings:e={proxy:{mode:0,address:"",username:"",password:""}},fetchProxySettings:t=(()=>{}),updateProxySettings:n=(()=>{}),restartClient:s=(()=>{})})=>{(0,Nt.useEffect)((()=>{t()}),[t]);const r=(0,Nt.useCallback)(((t,s)=>{if(function(e){return!!Rs.includes(e)}(t)){const r={...e.proxy};switch(t){case"network.proxy.mode":r.mode=s;break;case"network.proxy.addr":r.address=s;break;case"network.proxy.user":r.username=s;break;case"network.proxy.pass":r.password=s}n(r)}return Promise.resolve()}),[e,n]);return(0,At.jsxs)("main",{className:"Settings","aria-labelledby":"settings-form-title","data-testid":"settings",children:[(0,At.jsx)("h1",{className:"HeroText",id:"settings-form-title",children:pt.get("desktop.login.PreferencesLink")}),(0,At.jsx)(js,{mode:e.proxy.mode,addr:e.proxy.address,user:e.proxy.username,pass:e.proxy.password,setValue:r,restartContainer:s,fullWidth:!0})]})}));class Gs extends Nt.PureComponent{constructor(e){super(e),this.handleSettingsClick=this.goToSettingsPage.bind(this),this.handleBackToLoginClick=this.handleBackToLoginClick.bind(this)}handleSignupClick(){const{openSignupPage:e,onInteraction:t}=this.props,n=Ot();e(n),t("login/welcome","click","open-page-signup",null,n)}handleBackToLoginClick(e){e.preventDefault(),this.props.openLoginPage(),this.props.onInteraction(this.props.mode,"click","back-to-login")}goToSettingsPage(e){e.preventDefault(),this.props.openSettingsPage(),this.props.onInteraction(this.props.mode,"click","open-page-settings")}renderPreferencesLink(){return(0,At.jsx)("a",{className:"Footer__link",href:"#",onClick:this.handleSettingsClick,"data-ta-id":"login-footer-settings",children:pt.get("desktop.login.PreferencesLink")})}renderBackToLoginLink(){return(0,At.jsx)("a",{className:"Footer__link",href:"#",onClick:this.handleBackToLoginClick,"data-ta-id":"login-footer-settings-back-to-login",children:pt.get("desktop.login.Back")})}renderTryAgain(){return(0,At.jsxs)(At.Fragment,{children:[(0,At.jsx)("span",{children:pt.get("desktop-auth.login.not-seeing-browser")})," ",(0,At.jsx)("a",{href:"#",onClick:()=>this.props.tryAgainHandler(),children:pt.get("desktop-auth.login.try-again")})]})}renderSignupLink(){return(0,At.jsx)("a",{className:"Footer__NoUnderline",href:"#",id:"signup-link",onClick:()=>this.handleSignupClick(),"data-ta-id":"welcome-signup-link",dangerouslySetInnerHTML:{__html:pt.get("desktop.login.DontHaveAnAccountSignup")}})}renderRussiaLegalFormLink(){return(0,At.jsx)("div",{children:(0,At.jsx)("a",{className:"Footer__link",href:"https://support.spotify.com/ru-ru/contact-spotify-legal-form/",target:"_blank",rel:"noopener",children:"Форма для Ваших обращений"})})}renderMode(e,t){return"login"===e||"welcome"===e&&t?this.renderPreferencesLink():"settings"===e?this.renderBackToLoginLink():"open-browser"===e?this.renderTryAgain():"welcome"===e?this.renderSignupLink():null}render(){const{mode:e,country:t,isAuthOnWebEnabled:n}=this.props;return(0,At.jsxs)("footer",{className:"Footer",role:"contentinfo",children:[this.renderMode(e,n),"RU"===t&&this.renderRussiaLegalFormLink()]})}}const Bs=(0,d.$j)((e=>({country:e.signup.restrictions?.country})),(e=>({tryAgainHandler:()=>{e(It.abortLoginWithAccounts()),e(It.enterWelcomeMode())},openLoginPage:()=>{e(It.enterLoginMode())},openSignupPage:t=>e(It.enterSignupMode(t)),openSettingsPage:()=>e(It.enterSettingsMode()),onInteraction:(t,n,s,r,o)=>e(It.interaction(t,n,s,r,o))})))(Gs);class Ws extends Nt.PureComponent{render(){return(0,At.jsxs)("header",{className:"Header",children:[(0,At.jsx)("h1",{className:"glue-hidden-visually",children:"Spotify"}),(0,At.jsx)("img",{className:"Header__logo",src:"images/logo.svg",alt:""})]})}}var Vs=n(1141),$s=n(5879),Hs=n(3600);const Ks=(0,n(2638).JP)({name:"enableAuthOnWeb",description:"Property to enable experiment to use web authentication for Desktop application.",default:!1});class Ys extends Nt.Component{static defaultProps={throbberDelay:0,transitionLeaveTimeout:0};renderFakeWebPlayer(){return(0,At.jsxs)("div",{className:"fakeWebPlayer",children:[(0,At.jsx)("aside",{}),(0,At.jsxs)("footer",{children:[(0,At.jsx)("div",{className:"fakeWebPlayer__footer-left"}),(0,At.jsx)("div",{className:"fakeWebPlayer__footer-center"}),(0,At.jsx)("div",{className:"fakeWebPlayer__footer-right"})]}),(0,At.jsx)("main",{children:(0,At.jsx)("div",{className:"fakeWebPlayer__content"})})]})}renderMode(e,t,n,s){return"settings"===e?(0,At.jsx)(Us,{}):n?(0,At.jsx)(en,{eventSender:s}):"welcome"===e?(0,At.jsx)(Rt,{}):"signup"===e?(0,At.jsx)(Ln,{step:t}):"login"===e?(0,At.jsx)(Wn,{}):"open-browser"===e?(0,At.jsx)($n,{}):null}render(){const{loading:e,mode:t,loggedIn:n,previousMode:s,throbberDelay:r,signupStep:o,previousSignupStep:i,isAuthOnWebEnabled:a,eventSender:l}=this.props;if(e||!t)return(0,At.jsx)(Pt,{delay:r});if(n)return null;let d=s?`__${t} __${s}-to-${t}`:"";return"signup"===t&&Number.isInteger(i)&&(d+=` __signup_step_${i}_to_${o}`),(0,At.jsxs)("main",{className:"App","data-ta-id":"login-app","data-testid":"login-app","data-ta-login-mode":t,children:[this.renderFakeWebPlayer(),(0,At.jsx)("div",{className:`App__content ${d}`,children:(0,At.jsx)($s.Z,{mode:"in-out",children:(0,At.jsx)(Vs.Z,{timeout:{appear:0,enter:0,exit:650},children:(0,At.jsxs)("div",{className:`App__modal ${d}`,children:[(0,At.jsx)(Ws,{}),this.renderMode(t,o,a,l),(0,At.jsx)(Bs,{mode:t,isAuthOnWebEnabled:a})]})},d)})})]},"main1")}}const qs=(0,Hs.yS)({isAuthOnWebEnabled:Ks}),zs=(0,d.$j)((e=>({mode:e.app.mode,previousMode:e.app.previousMode,signupStep:e.signup.step,previousSignupStep:e.signup.previousStep,loading:!!e.login.loading,loggedIn:!!e.login.loggedIn,throbberDelay:e.login.throbberDelay,transitionLeaveTimeout:e.login.redirectDelay})))(qs(Ys));var Js=n(5583),Xs=n(1958);const Zs=e=>t=>n=>{const s=t(n);switch(n.type){case It.START_APP:e.dispatch(It.getSignupRestrictions());!E.getItem("lastUsername")?e.dispatch(It.enterWelcomeMode()):e.dispatch(It.enterLoginMode());break;case It.LOGIN_FAIL:{const t=e.getState();if(n.loginType===It.LOGIN_TYPE_AUTOLOGIN){const n=t.app.mode;"welcome"===n?e.dispatch(It.enterWelcomeMode()):"login"===n?e.dispatch(It.enterLoginMode()):"signup"===n&&e.dispatch(It.enterSignupMode())}else{if("open-browser"===t.app.mode){const s=n.errorData;let r=Gt(s.errorCategory,s.errorCode,s.errorReference);"desktop_login_accounts"===s.errorCategory&&4===s.errorCode&&(r="signup"===t.experimentWebAuthReducer.operationUsed?pt.get("desktop-auth.login.signup-time-out"):pt.get("desktop-auth.login.login-time-out")),r?e.dispatch(It.enterWelcomeMode(r)):e.dispatch(It.enterWelcomeMode())}}break}case It.ENTER_SIGNUP_MODE:{const t=e.getState().signup.restrictions;t?!1===t.is_country_launched&&e.dispatch(It.countryNotLaunched()):e.dispatch(It.getSignupRestrictions());break}case It.SIGNUP_RESTRICTIONS_SUCCESS:!1===n.restrictions.is_country_launched&&e.dispatch(It.countryNotLaunched());break;case It.SIGNUP_FAILURE:(n.errors.email||n.errors.password||n.errors.displayname)&&e.dispatch(It.enterSignupModeStep0());break;case It.COUNTRY_NOT_LAUNCHED:e.dispatch(It.openSignupPage(!0))}return s},Qs=e=>{window.location.href=e},er=()=>e=>t=>{const n=e(t);if(!t.redirectTo)return n;let s;return"xpui"!==t.redirectTo||(s="spotify:app:xpui",t.redirectDelay?setTimeout((()=>{Qs(s)}),t.redirectDelay):Qs(s)),n},tr={errorMessage:null};const nr=function(e=tr,t){switch(t.type){case It.ENTER_SIGNUP_MODE:return{...e,previousMode:e.mode,mode:"signup"};case It.ENTER_LOGIN_MODE:case It.COUNTRY_NOT_LAUNCHED:return{...e,previousMode:e.mode,mode:"login"};case It.ENTER_WELCOME_MODE:return{...e,previousMode:e.mode,mode:"welcome",errorMessage:t.errorMessage??null};case It.ENTER_SETTINGS_MODE:return{...e,previousMode:e.mode,mode:"settings"};default:return e}};const sr={proxy:{mode:0,address:"",username:"",password:""}};const rr=function(e=sr,t){return function(e){return e.type===It.SETTINGS_FETCH_PROXY_SETTINGS_SUCCESS}(t)?{...e,proxy:{mode:t.data.mode,address:t.data.address,username:t.data.username,password:t.data.password}}:e},or={step:0,isAttempting:!1,isSuccessful:void 0,errors:{},errorData:{},validated:{},formData:{name:"",email:"",password:"",birthDate:{day:void 0,month:void 0,year:void 0},gender:void 0,sendEmail:void 0,shareData:void 0,agreeEula:!1},restrictions:void 0};const ir=function(e=or,t){switch(t.type){case It.ENTER_SIGNUP_MODE_STEP_0:return{...e,previousStep:e.step,step:0};case It.ENTER_SIGNUP_MODE_STEP_1:return{...e,previousStep:e.step,step:1};case It.SIGNUP_RESTRICTIONS_SUCCESS:return{...e,formData:{...e.formData,sendEmail:!!t.restrictions.requires_marketing_opt_in_text||void 0,agreeEula:!!t.restrictions.pretick_eula},restrictions:t.restrictions};case It.SIGNUP_RESTRICTIONS_FAILURE:return{...e,errorData:t.error};case It.SIGNUP_ATTEMPT:return{...e,isAttempting:!0,errorData:null};case It.SIGNUP_SUCCESS:return{...e,isAttempting:!0,isSuccessful:!0,errorData:null};case It.SIGNUP_FAILURE:return{...e,isAttempting:!1,isSuccessful:!1,errors:t.errors,errorData:null};case It.FACEBOOK_SIGNUP_ATTEMPT:return{...e,errorData:null,errors:{}};case It.FACEBOOK_SIGNUP_FAILURE:return{...e,errorData:t.errorData};case It.VALIDATE_FIELD_ATTEMPT:return{...e,errors:{...e.errors,[t.field]:void 0}};case It.VALIDATE_FIELD_FAILURE:return{...e,errors:{...e.errors,[t.field]:t.error},validated:{...e.validated,[t.field]:!1}};case It.VALIDATE_FIELD_SUCCESS:return{...e,errors:{...e.errors,[t.field]:void 0},validated:{...e.validated,[t.field]:!0}};case It.UPDATE_SIGNUP_DATA:{const n={};for(const e of Object.keys(t.data))n[e]=void 0;return{...e,errors:{...e.errors,...n},formData:{...e.formData,...t.data}}}case It.CLEAR_ALL_ERRORS:return{...e,errors:{}};default:return e}};function ar(e){const t=(0,Js.MT)((0,Js.UY)({app:nr,login:I,settings:rr,signup:ir}),void 0,(0,Js.md)(Xs.Z,Zs,(e=>{const t=new Zt(e);return()=>e=>n=>{const s=e(n);switch(n.type){case It.ENTER_LOGIN_MODE:t.logPageView({page:"login"});break;case It.LOGIN_SUCCESS:n.loginType===It.LOGIN_TYPE_EMAIL?t.logAction({page:"login",action_type:"view",action_intent:"show-success-login-email"}):n.loginType===It.LOGIN_TYPE_FACEBOOK&&t.logAction({page:"login",action_type:"view",action_intent:"show-success-login-facebook"});break;case It.LOGIN_FAIL:n.loginType===It.LOGIN_TYPE_EMAIL?n.errorData&&3===n.errorData.errorCode&&t.logAction({page:"login",action_type:"view",action_intent:"show-error-invalid-credential"}):n.loginType===It.LOGIN_TYPE_FACEBOOK&&t.logAction({page:"login",action_type:"view",action_intent:"show-error-login-facebook"});break;case It.ENTER_SIGNUP_MODE:t.logPageView({page:"signup"});break;case It.ENTER_SIGNUP_MODE_STEP_0:t.logAction({page:"signup",action_type:"view",action_intent:"show-signup-step-one"});break;case It.ENTER_SIGNUP_MODE_STEP_1:t.logAction({page:"signup",action_type:"view",action_intent:"show-signup-step-two"});break;case It.SIGNUP_SUCCESS:t.logAction({page:"signup",action_type:"view",action_intent:"show-success-signup-email"});break;case It.SIGNUP_FAILURE:t.logAction({page:"signup",action_type:"view",action_intent:"show-error-signup-email",item_id:n.errors&&Object.keys(n.errors).join("|")});break;case It.FACEBOOK_SIGNUP_SUCCESS:t.logAction({page:"signup",action_type:"view",action_intent:"show-success-authentication-facebook"});break;case It.FACEBOOK_SIGNUP_FAILURE:t.logAction({page:"signup",action_type:"view",action_intent:"show-error-authentication-facebook",item_id:n.errorData&&`${n.errorData.errorCode} - ${n.errorData.errorDescription}`});break;case It.ENTER_WELCOME_MODE:t.logPageView({page:"login/welcome"});break;case It.ENTER_SETTINGS_MODE:t.logPageView({page:"login/settings"});break;case It.INTERACTION:t.logAction({page:n.page,action_type:n.interactionType,action_intent:n.intent,item_id:n.itemId,action_hash:n.actionHash});break;case It.VALIDATE_FIELD_FAILURE:if(n.error){const e=n.field,s=n.error.code;let r=null,o=null;"valueMissing"===s?r=`show-error-empty-${e}`:["incomplete","invalid","typeMismatch","tooShort"].includes(s)?r=`show-error-format-${e}`:(r=`show-error-${e}`,o=n.error.message||""),null!==r&&t.logAction({page:"signup",action_type:"view",action_intent:r,...o?{item_id:o}:{}})}}return s}})(e),er));return t.subscribe((()=>{const e=t.getState();e.login.username&&localStorage.setItem(k,e.login.username),e.login.utmParameters&&localStorage.setItem(C,JSON.stringify(e.login.utmParameters))})),t}var lr=n(8896),dr=n(1252);let cr=null;var ur=n(7828),pr=n(1580);const gr=(e,t)=>{const n=e.event_sender_context_information;return[(0,pr.UY)({version_code:n.client_version_int,version_string:n.client_version_string}),(0,pr.jx)(t),(0,pr.IE)(n.installation_id),(0,pr.CF)({device_id:n.device_id,device_manufacturer:n.device_manufacturer,device_model:n.device_model,os_version:n.os_version,platform_type:n.platform_type})]};var hr=n(7871);(async function(){for(const e of[window.__spotify.locale,it.en])try{const t=await fetch(`i18n/${e}.json`).then((e=>e.json()));return pt.setLocale(e),void pt.setDictionary(t)}catch(e){0}throw new Error("Cannot find a suitable locale! Something is wrong: talk to #desktop.")})().then((async function(){const e=function(){const e=(0,dr.qy)({providers:{endpoints:(0,dr.uG)(),token:()=>null}});return e.connect(),e}();cr=e;const t=((e,t,n)=>(0,ur.mi)({transport:t,suppressPersist:!1,context:gr(e,n)}))(window.__spotify,e,"65b708073fc0480ea92a077233ca87bd"),n=ar(t);u.attach(),u.update(),c.attach();const s=document.location.search,r=new RegExp(`\\?param=error-code\\${encodeURIComponent("=")}([0-9]+)`,"i");window.addEventListener("message",(e=>{"critical-update-error"===e.data&&n.dispatch(It.loginFailed({errorCode:e.data}))}));const o=s.match(r);if(s&&o){const e=+o[1];n.dispatch(It.loginFailed({errorCode:e}))}let i="linux";window.navigator.platform.startsWith("Mac")&&(i="mac"),window.navigator.platform.startsWith("Win")&&(i="windows"),document.body.classList.add(`body-container--${i}`),a.render((0,At.jsx)(l.zj,{children:(0,At.jsx)(d.zt,{store:n,children:(0,At.jsx)(Hs.nD,{resolver:hr.L,context:{username:null},options:{clientId:"client-desktop-ui-app-login",timeout:5e3,transport:e,eventSender:t,installationId:window.__spotify.event_sender_context_information?.installation_id},children:(0,At.jsx)(Nt.Suspense,{fallback:null,children:(0,At.jsx)(zs,{eventSender:t})})})})}),document.getElementById("main")),n.dispatch(It.startApp()),document.documentElement.setAttribute("dir",window.__spotify.localization_is_rtl?"rtl":"ltr");const p={[lr.PLATFORM_UNKNOWN]:"body-container--unknown-os",[lr.PLATFORM_MAC]:"body-container--mac",[lr.PLATFORM_WINDOWS]:"body-container--windows"},g=(0,lr.getPlatform)();document.body.classList.add(p[g])}))},8896:(e,t,n)=>{"use strict";n.r(t),n.d(t,{PLATFORM_MAC:()=>r,PLATFORM_UNKNOWN:()=>s,PLATFORM_WINDOWS:()=>o,getPlatform:()=>l,isMac:()=>i,isWindows:()=>a});const s=Symbol("PLATFORM_UNKNOWN"),r=Symbol("PLATFORM_MAC"),o=Symbol("PLATFORM_WINDOWS");function i(){return window.navigator.platform.startsWith("Mac")}function a(){return window.navigator.platform.startsWith("Win")}function l(){return i()?r:a()?o:s}},890:(e,t)=>{let n=!1;t.update=()=>{},t.attach=()=>{if(n)return;n=!0;const e=window.__spotify&&window.__spotify.locale;e&&document.documentElement.setAttribute("lang",e)},t.detach=()=>{n&&(n=!1,document.documentElement.removeAttribute("lang"))}},6286:(e,t,n)=>{n(817);const{getPlatform:s,PLATFORM_UNKNOWN:r,PLATFORM_MAC:o,PLATFORM_WINDOWS:i}=n(8896);let a=!1,l="always-visible",d=0;const c={[r]:"linux",[o]:"mac",[i]:"windows"};let u=c[r];function p(){const e=[...document.querySelectorAll("*")],t=[],n=["scroll","auto","overlay"];e.forEach((e=>{const s=window.getComputedStyle(e),r=s.overflowX,o=s.overflowY;n.includes(r)&&t.push({node:e,property:"overflow-x"}),n.includes(o)&&t.push({node:e,property:"overflow-y"})}));const s=document.createElement("style");s.innerHTML="\n    html::-webkit-scrollbar,\n    body::-webkit-scrollbar {\n      background-color: rgba(1, 2, 3, 0) !important;\n    }\n  ".trimRight();const r=`data-scrollbar-fix-${++d}-id`;let o=0;t.forEach((({node:e,property:t})=>{if(e!==document.body){const n=++o;e.setAttribute(r,n),s.innerHTML+=`\n    [${r}="${n}"] { ${t}: hidden !important; }`}})),document.head.appendChild(s),setTimeout((()=>{document.head.removeChild(s),t.forEach((({node:e})=>{e.removeAttribute(r)}))}),0)}t.performScrollBarFix=p,t.update=function(){},t.attach=function(){if(a)return;a=!0;const e=window.__spotify&&window.__spotify.scroller_style;l="overlay"===e?"overlay":"always-visible";const t=s();u=c[t],"always-visible"===l||"mac"!==u?(document.body.classList.remove("scrollbar-style-when-scrolling-mac"),document.body.classList.add(`scrollbar-style-visible-${u}`)):(document.body.classList.remove(`scrollbar-style-visible-${u}`),document.body.classList.add("scrollbar-style-when-scrolling-mac")),window.addEventListener("message",(e=>{"set_active"===e.data.name&&e.data.active&&p()}))},t.detach=function(){a&&(a=!1,d=0)}}},n={};function s(e){var r=n[e];if(void 0!==r)return r.exports;var o=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(o.exports,o,o.exports,s),o.loaded=!0,o.exports}s.m=t,s.amdO={},e=[],s.O=(t,n,r,o)=>{if(!n){var i=1/0;for(c=0;c<e.length;c++){for(var[n,r,o]=e[c],a=!0,l=0;l<n.length;l++)(!1&o||i>=o)&&Object.keys(s.O).every((e=>s.O[e](n[l])))?n.splice(l--,1):(a=!1,o<i&&(i=o));if(a){e.splice(c--,1);var d=r();void 0!==d&&(t=d)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[n,r,o]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={535:0};s.O.j=t=>0===e[t];var t=(t,n)=>{var r,o,[i,a,l]=n,d=0;if(i.some((t=>0!==e[t]))){for(r in a)s.o(a,r)&&(s.m[r]=a[r]);if(l)var c=l(s)}for(t&&t(n);d<i.length;d++)o=i[d],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return s.O(c)},n=("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),s.nc=void 0;var r=s.O(void 0,[569],(()=>s(2466)));r=s.O(r)})();
//# sourceMappingURL=login.js.map